{"version":3,"file":"visual.js","mappings":"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","sources":["webpack:///./src/visual.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./.tmp/precompile/visualPlugin.ts"],"sourcesContent":["\"use strict\";\n\nimport powerbi from \"powerbi-visuals-api\";\nimport VisualConstructorOptions = powerbi.extensibility.visual.VisualConstructorOptions;\nimport VisualUpdateOptions = powerbi.extensibility.visual.VisualUpdateOptions;\nimport IVisual = powerbi.extensibility.visual.IVisual;\nimport IVisualHost = powerbi.extensibility.visual.IVisualHost;\nimport VisualObjectInstance = powerbi.VisualObjectInstance;\nimport EnumerateVisualObjectInstancesOptions = powerbi.EnumerateVisualObjectInstancesOptions;\nimport VisualObjectInstanceEnumerationObject = powerbi.VisualObjectInstanceEnumerationObject;\n\nimport \"../style/visual.less\";\n\nexport class Visual implements IVisual {\n    private target: HTMLElement;\n    private table: HTMLTableElement;\n    private host: IVisualHost;\n    private categories: any; \n\n    constructor(options: VisualConstructorOptions) {\n        this.host = options.host;\n        this.target = options.element;\n        this.table = document.createElement(\"table\");\n        this.target.appendChild(this.table);\n    }\n\n    public update(options: VisualUpdateOptions) {\n        this.table.innerHTML = \"\";\n        \n        const dataView = options.dataViews[0];\n        if (!dataView || !dataView.categorical || !dataView.categorical.categories) return;\n\n        const categorical = dataView.categorical;\n        const categoryColumn = categorical.categories[0];\n        const valuesColumns = categorical.values;\n\n        this.categories = categoryColumn;\n\n        // --- En-têtes ---\n        const thead = document.createElement(\"thead\");\n        const headerRow = document.createElement(\"tr\");\n        \n        const thCat = document.createElement(\"th\");\n        thCat.innerText = categoryColumn.source.displayName;\n        headerRow.appendChild(thCat);\n\n        if(valuesColumns) {\n            valuesColumns.forEach(valCol => {\n                const th = document.createElement(\"th\");\n                th.innerText = valCol.source.displayName;\n                headerRow.appendChild(th);\n            });\n        }\n        thead.appendChild(headerRow);\n        this.table.appendChild(thead);\n\n        // --- Corps du tableau ---\n        const tbody = document.createElement(\"tbody\");\n        \n        categoryColumn.values.forEach((categoryValue, index) => {\n            const tr = document.createElement(\"tr\");\n\n            // 1. Valeurs par défaut\n            let textColor = \"black\"; \n            let bgColor = \"transparent\"; // <--- NOUVEAU (Transparent par défaut)\n            let fontSize = 12;\n            let fontFamily = \"'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif\"; // <--- NOUVEAU\n\n            // 2. Lecture des objets (Saved settings)\n            if (categoryColumn.objects && categoryColumn.objects[index]) {\n                const obj = categoryColumn.objects[index];\n                if (obj[\"configLigne\"]) {\n                     const props = obj[\"configLigne\"];\n                     \n                     // Couleur Texte\n                     if (props[\"couleurTexte\"]) \n                        textColor = (props[\"couleurTexte\"] as any).solid.color;\n                     \n                     // Couleur Fond (<--- NOUVEAU)\n                     if (props[\"arrierePlan\"]) \n                        bgColor = (props[\"arrierePlan\"] as any).solid.color;\n\n                     // Taille\n                     if (props[\"taillePolice\"])\n                        fontSize = props[\"taillePolice\"] as number;\n\n                     // Police (<--- NOUVEAU)\n                     if (props[\"police\"])\n                        fontFamily = props[\"police\"] as string;\n                }\n            }\n\n            // 3. Application du style CSS\n            tr.style.color = textColor;\n            tr.style.backgroundColor = bgColor; // <--- NOUVEAU\n            tr.style.fontSize = fontSize + \"px\";\n            tr.style.fontFamily = fontFamily;   // <--- NOUVEAU\n\n            // Remplissage des cellules\n            const tdCat = document.createElement(\"td\");\n            tdCat.innerText = categoryValue.toString();\n            tr.appendChild(tdCat);\n\n            if(valuesColumns) {\n                valuesColumns.forEach(valCol => {\n                    const td = document.createElement(\"td\");\n                    td.innerText = valCol.values[index] ? valCol.values[index].toString() : \"0\";\n                    tr.appendChild(td);\n                });\n            }\n            tbody.appendChild(tr);\n        });\n        this.table.appendChild(tbody);\n    }\n\n    public enumerateObjectInstances(options: EnumerateVisualObjectInstancesOptions): VisualObjectInstance[] | VisualObjectInstanceEnumerationObject {\n        const instances: VisualObjectInstance[] = [];\n        if (!this.categories) return instances;\n\n        if (options.objectName === \"configLigne\") {\n            this.categories.values.forEach((value, index) => {\n                \n                const selectionId = this.host.createSelectionIdBuilder()\n                    .withCategory(this.categories, index)\n                    .createSelectionId();\n\n                // Valeurs actuelles pour le menu\n                let currentTextColor = \"black\";\n                let currentBgColor = \"\"; // Vide = transparent\n                let currentSize = 12;\n                let currentFont = \"\";\n\n                if (this.categories.objects && this.categories.objects[index]) {\n                    const obj = this.categories.objects[index];\n                    if (obj[\"configLigne\"]) {\n                        // Lecture Texte\n                        if (obj[\"configLigne\"][\"couleurTexte\"]) \n                            currentTextColor = (obj[\"configLigne\"][\"couleurTexte\"] as any).solid.color;\n                        \n                        // Lecture Fond (<--- NOUVEAU)\n                        if (obj[\"configLigne\"][\"arrierePlan\"]) \n                            currentBgColor = (obj[\"configLigne\"][\"arrierePlan\"] as any).solid.color;\n\n                        // Lecture Taille\n                        if (obj[\"configLigne\"][\"taillePolice\"]) \n                            currentSize = obj[\"configLigne\"][\"taillePolice\"] as number;\n\n                        // Lecture Police (<--- NOUVEAU)\n                        if (obj[\"configLigne\"][\"police\"]) \n                            currentFont = obj[\"configLigne\"][\"police\"] as string;\n                    }\n                }\n\n                instances.push({\n                    objectName: \"configLigne\",\n                    displayName: value.toString(),\n                    selector: selectionId.getSelector(),\n                    properties: {\n                        couleurTexte: { solid: { color: currentTextColor } },\n                        arrierePlan: { solid: { color: currentBgColor } }, // <--- NOUVEAU\n                        taillePolice: currentSize,\n                        police: currentFont // <--- NOUVEAU\n                    }\n                });\n            });\n        }\n        return instances;\n    }\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Visual } from \"../../src/visual\";\nimport powerbiVisualsApi from \"powerbi-visuals-api\";\nimport IVisualPlugin = powerbiVisualsApi.visuals.plugins.IVisualPlugin;\nimport VisualConstructorOptions = powerbiVisualsApi.extensibility.visual.VisualConstructorOptions;\nimport DialogConstructorOptions = powerbiVisualsApi.extensibility.visual.DialogConstructorOptions;\nvar powerbiKey: any = \"powerbi\";\nvar powerbi: any = window[powerbiKey];\nvar monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG: IVisualPlugin = {\n    name: 'monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG',\n    displayName: 'monTableauPerso',\n    class: 'Visual',\n    apiVersion: '5.3.0',\n    create: (options?: VisualConstructorOptions) => {\n        if (Visual) {\n            return new Visual(options);\n        }\n        throw 'Visual instance not found';\n    },\n    createModalDialog: (dialogId: string, options: DialogConstructorOptions, initialState: object) => {\n        const dialogRegistry = (<any>globalThis).dialogRegistry;\n        if (dialogId in dialogRegistry) {\n            new dialogRegistry[dialogId](options, initialState);\n        }\n    },\n    custom: true\n};\nif (typeof powerbi !== \"undefined\") {\n    powerbi.visuals = powerbi.visuals || {};\n    powerbi.visuals.plugins = powerbi.visuals.plugins || {};\n    powerbi.visuals.plugins[\"monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG\"] = monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG;\n}\nexport default monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG;"],"names":[],"ignoreList":[],"sourceRoot":""}