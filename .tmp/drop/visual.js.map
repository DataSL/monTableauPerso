{"version":3,"file":"visual.js","mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,+EAAU;AAC3D;AACA,iCAAiC,gBAAgB;AACjD,sCAAsC,gBAAgB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,wGAAwG;AAC7J;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,oGAAoG;AACrJ;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,4BAA4B,kDAAkD;AAC9E;AACA,yEAAyE,gBAAgB;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,oBAAoB,GAAG,uBAAuB;AAC3F;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,kFAAa;AACzC;AACA,oDAAoD,+EAAU;AAC9D,6BAA6B,gBAAgB;AAC7C,kCAAkC,gBAAgB;AAClD;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,iEAAe,yBAAyB,EAAC;AACzC,qD;;;;;;;;;;;;;AC/LqE;AACD;AACX;AACzD,iC;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AAC4E;AAC5E;AACA;AACO;AACP;AACO;AACP;AACA;AACO;AACP;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2BAA2B;AACxE;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,wBAAwB,kFAAsC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,qBAAqB,qFAAyC;AAC9D;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,gEAAgE;AAC5J;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,oFAAoF;AAChL;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,uBAAuB;AACnH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,qKAAqK;AACjQ;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,mBAAmB;AAC/G;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,gEAAgE;AAC5J;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,6BAA6B;AACzH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,6BAA6B;AACzH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,4EAA4E;AACxK;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,mBAAmB;AAC/G;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,6CAA6C,+CAA+C,+BAA+B;AAC3H;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;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","sources":["webpack:///./src/settings.ts","webpack:///./node_modules/powerbi-visuals-utils-formattingmodel/lib/utils/FormattingSettingsUtils.js","webpack:///./node_modules/powerbi-visuals-utils-formattingmodel/lib/FormattingSettingsService.js","webpack:///./node_modules/powerbi-visuals-utils-formattingmodel/lib/index.js","webpack:///./node_modules/powerbi-visuals-utils-formattingmodel/lib/FormattingSettingsComponents.js","webpack:///./src/visual.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./.tmp/precompile/visualPlugin.ts"],"sourcesContent":["\r\n\"use strict\";\r\n\r\nimport { formattingSettings } from \"powerbi-visuals-utils-formattingmodel\";\r\nimport powerbi from \"powerbi-visuals-api\";\r\n\r\nimport FormattingSettingsCard = formattingSettings.SimpleCard;\r\nimport FormattingSettingsSlice = formattingSettings.Slice;\r\nimport FormattingSettingsModel = formattingSettings.Model;\r\n\r\n// =========================================================\r\n// AFFICHAGE DU BOUTON D'ACTION\r\n// =========================================================\r\nexport class ActionButtonSettings extends FormattingSettingsCard {\r\n    name: string = \"actionButton\";\r\n    displayName: string = \"Bouton d'action\";\r\n\r\n    show = new formattingSettings.ToggleSwitch({\r\n        name: \"show\",\r\n        displayName: \"Afficher le bouton d'action\",\r\n        value: true\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [this.show];\r\n}\r\n\r\n\r\n// =========================================================\r\n// FOND DU CONTENEUR TABLEAU\r\n// =========================================================\r\nexport class BackgroundContainerSettings extends FormattingSettingsCard {\r\n    name: string = \"backgroundContainer\";\r\n    displayName: string = \"Fond du conteneur tableau\";\r\n\r\n    color = new formattingSettings.ColorPicker({\r\n        name: \"color\",\r\n        displayName: \"Couleur de fond\",\r\n        value: { value: \"#fff\" }\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [this.color];\r\n}\r\n\r\n// =========================================================\r\n// 0. TITRES COLONNES (Gnration dynamique)\r\n// =========================================================\r\nexport class TitresColonnesSettings extends FormattingSettingsCard {\r\n    name: string = \"titresColonnes\";\r\n    displayName: string = \"0. TITRES COLONNES\";\r\n    \r\n    slices: Array<FormattingSettingsSlice> = [];\r\n\r\n    constructor() {\r\n        super();\r\n        for (let i = 1; i <= 20; i++) {\r\n            this.slices.push(new formattingSettings.TextInput({\r\n                name: \"titre\" + i,\r\n                displayName: \"Titre Col \" + i,\r\n                value: \"\",\r\n                placeholder: \"Titre...\" // CORRECTION: Placeholder obligatoire\r\n            }));\r\n        }\r\n    }\r\n}\r\n\r\n// =========================================================\r\n// 1. MENU DE SLECTION\r\n// =========================================================\r\nexport class SelectionMenuSettings extends FormattingSettingsCard {\r\n    name: string = \"selectionMenu\";\r\n    displayName: string = \"1. SLECTION (Excel)\";\r\n\r\n    ligneActive = new formattingSettings.TextInput({\r\n        name: \"ligneActive\",\r\n        displayName: \"Nom exact de la ligne active\",\r\n        value: \"\",\r\n        placeholder: \"Ex: Chiffre d'affaires\" // CORRECTION\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [this.ligneActive];\r\n}\r\n\r\n// =========================================================\r\n// 2. STYLE DE LIGNE\r\n// =========================================================\r\nexport class StyleLigneSettings extends FormattingSettingsCard {\r\n    name: string = \"styleLigne\";\r\n    displayName: string = \"2. PERSONNALISATION (Excel)\";\r\n    \r\n    // CORRECTION: Ajout explicite du selector pour viter l'erreur TS\r\n    selector: powerbi.data.Selector; \r\n\r\n    // Positionnement\r\n    columnIndex = new formattingSettings.NumUpDown({\r\n        name: \"columnIndex\", displayName: \"N Colonne\", value: 1\r\n    });\r\n    ordreTri = new formattingSettings.NumUpDown({\r\n        name: \"ordreTri\", displayName: \"Position\", value: 0\r\n    });\r\n\r\n    // Marges\r\n    marginTop = new formattingSettings.NumUpDown({\r\n        name: \"marginTop\", displayName: \"Marge Haut\", value: 0\r\n    });\r\n    marginBottom = new formattingSettings.NumUpDown({\r\n        name: \"marginBottom\", displayName: \"Marge Bas\", value: 0\r\n    });\r\n    marginColor = new formattingSettings.ColorPicker({\r\n        name: \"marginColor\", displayName: \"Couleur Marge\", value: { value: \"transparent\" }\r\n    });\r\n\r\n    // Visibilit / Header\r\n    isHidden = new formattingSettings.ToggleSwitch({\r\n        name: \"isHidden\", displayName: \"MASQUER\", value: false\r\n    });\r\n    isHeader = new formattingSettings.ToggleSwitch({\r\n        name: \"isHeader\", displayName: \"Mode Titre\", value: false\r\n    });\r\n\r\n    // Contenu\r\n    customLabel = new formattingSettings.TextInput({\r\n        name: \"customLabel\", displayName: \"Renommer\", value: \"\",\r\n        placeholder: \"Nouveau nom...\" // CORRECTION\r\n    });\r\n    customAmount = new formattingSettings.TextInput({\r\n        name: \"customAmount\", displayName: \"Remplacer Montant\", value: \"\",\r\n        placeholder: \"Valeur ou vide...\" // CORRECTION\r\n    });\r\n\r\n    // Police\r\n    fontSize = new formattingSettings.NumUpDown({\r\n        name: \"fontSize\", displayName: \"Taille\", value: 12\r\n    });\r\n    fontFamily = new formattingSettings.FontPicker({\r\n        name: \"fontFamily\", displayName: \"Police\", value: \"'Segoe UI', sans-serif\"\r\n    });\r\n\r\n    // Style Libell\r\n    bgLabel = new formattingSettings.ColorPicker({\r\n        name: \"bgLabel\", displayName: \"Fond Libell\", value: { value: \"transparent\" }\r\n    });\r\n    fillLabel = new formattingSettings.ColorPicker({\r\n        name: \"fillLabel\", displayName: \"Texte Libell\", value: { value: \"black\" }\r\n    });\r\n    boldLabel = new formattingSettings.ToggleSwitch({\r\n        name: \"boldLabel\", displayName: \"Gras (L)\", value: false\r\n    });\r\n    italicLabel = new formattingSettings.ToggleSwitch({\r\n        name: \"italicLabel\", displayName: \"Italique (L)\", value: false\r\n    });\r\n\r\n    // Style Prix\r\n    bgAmount = new formattingSettings.ColorPicker({\r\n        name: \"bgAmount\", displayName: \"Fond Prix\", value: { value: \"transparent\" }\r\n    });\r\n    fillAmount = new formattingSettings.ColorPicker({\r\n        name: \"fillAmount\", displayName: \"Texte Prix\", value: { value: \"black\" }\r\n    });\r\n    boldAmount = new formattingSettings.ToggleSwitch({\r\n        name: \"boldAmount\", displayName: \"Gras (P)\", value: false\r\n    });\r\n\r\n    // Bordures spcifiques\r\n    borderWidth = new formattingSettings.NumUpDown({\r\n        name: \"borderWidth\", displayName: \"Largeur Bordure\", value: 1\r\n    });\r\n    borderColor = new formattingSettings.ColorPicker({\r\n        name: \"borderColor\", displayName: \"Couleur Bordure\", value: { value: \"#eee\" }\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [\r\n        this.columnIndex, this.ordreTri,\r\n        this.isHidden, this.isHeader,\r\n        this.marginTop, this.marginBottom, this.marginColor,\r\n        this.customLabel, this.customAmount,\r\n        this.fontSize, this.fontFamily,\r\n        this.fillLabel, this.bgLabel, this.boldLabel, this.italicLabel,\r\n        this.fillAmount, this.bgAmount, this.boldAmount,\r\n        this.borderWidth, this.borderColor\r\n    ];\r\n}\r\n\r\n// =========================================================\r\n// LIGNES MANUELLES\r\n// =========================================================\r\nexport class ManualLineSettings extends FormattingSettingsCard {\r\n    text = new formattingSettings.TextInput({\r\n        name: \"text\", displayName: \"Texte\", value: \"Nouvelle Ligne\",\r\n        placeholder: \"Libell...\" // CORRECTION\r\n    });\r\n    show = new formattingSettings.ToggleSwitch({\r\n        name: \"show\", displayName: \"Afficher\", value: false\r\n    });\r\n    col = new formattingSettings.NumUpDown({\r\n        name: \"col\", displayName: \"Colonne\", value: 1\r\n    });\r\n    pos = new formattingSettings.NumUpDown({\r\n        name: \"pos\", displayName: \"Position\", value: 0\r\n    });\r\n    isHeader = new formattingSettings.ToggleSwitch({\r\n        name: \"isHeader\", displayName: \"Titre\", value: false\r\n    });\r\n    bgColor = new formattingSettings.ColorPicker({\r\n        name: \"bgColor\", displayName: \"Fond\", value: { value: \"transparent\" }\r\n    });\r\n    textColor = new formattingSettings.ColorPicker({\r\n        name: \"textColor\", displayName: \"Texte\", value: { value: \"black\" }\r\n    });\r\n    marginTop = new formattingSettings.NumUpDown({\r\n        name: \"marginTop\", displayName: \"Marge Haut\", value: 0\r\n    });\r\n    fontSize = new formattingSettings.NumUpDown({\r\n        name: \"fontSize\", displayName: \"Taille\", value: 12\r\n    });\r\n    bold = new formattingSettings.ToggleSwitch({\r\n        name: \"bold\", displayName: \"Gras\", value: false\r\n    });\r\n    italic = new formattingSettings.ToggleSwitch({\r\n        name: \"italic\", displayName: \"Italique\", value: false\r\n    });\r\n    borderWidth = new formattingSettings.NumUpDown({\r\n        name: \"borderWidth\", displayName: \"Largeur Bordure\", value: 1\r\n    });\r\n    borderColor = new formattingSettings.ColorPicker({\r\n        name: \"borderColor\", displayName: \"Couleur Bordure\", value: { value: \"#eee\" }\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [\r\n        this.show, this.text, this.col, this.pos,\r\n        this.isHeader, this.marginTop,\r\n        this.textColor, this.bgColor,\r\n        this.fontSize, this.bold, this.italic,\r\n        this.borderWidth, this.borderColor\r\n    ];\r\n}\r\n\r\n// =========================================================\r\n// BORDURES TABLEAU GLOBAL\r\n// =========================================================\r\nexport class TableBordersSettings extends FormattingSettingsCard {\r\n    name: string = \"tableBorders\";\r\n    displayName: string = \" BORDURES TABLEAU\";\r\n\r\n    borderWidth = new formattingSettings.NumUpDown({\r\n        name: \"borderWidth\", displayName: \"Largeur\", value: 1\r\n    });\r\n    borderColor = new formattingSettings.ColorPicker({\r\n        name: \"borderColor\", displayName: \"Couleur\", value: { value: \"rgba(0,0,0,0.25)\" }\r\n    });\r\n    borderStyle = new formattingSettings.ItemDropdown({\r\n        name: \"borderStyle\",\r\n        displayName: \"Style\",\r\n        value: { value: \"solid\", displayName: \"Plein\" },\r\n        items: [\r\n            { value: \"solid\", displayName: \"Plein\" },\r\n            { value: \"dashed\", displayName: \"Tirets\" },\r\n            { value: \"dotted\", displayName: \"Pointills\" },\r\n            { value: \"double\", displayName: \"Double\" }\r\n        ]\r\n    });\r\n    borderRadius = new formattingSettings.NumUpDown({\r\n        name: \"borderRadius\", displayName: \"Arrondi\", value: 8\r\n    });\r\n\r\n    slices: Array<FormattingSettingsSlice> = [\r\n        this.borderWidth, this.borderColor, this.borderStyle, this.borderRadius\r\n    ];\r\n}\r\n\r\n// =========================================================\r\n// MODLE PRINCIPAL\r\n// =========================================================\r\nexport class VisualFormattingSettingsModel extends FormattingSettingsModel {\r\n    titresColonnes = new TitresColonnesSettings();\r\n    selectionMenu = new SelectionMenuSettings();\r\n    styleLigne = new StyleLigneSettings();\r\n    tableBorders = new TableBordersSettings();\r\n    backgroundContainer = new BackgroundContainerSettings();\r\n    actionButton = new ActionButtonSettings();\r\n\r\n    cards: FormattingSettingsCard[] = [\r\n        this.titresColonnes,\r\n        this.selectionMenu,\r\n        this.styleLigne,\r\n        this.tableBorders,\r\n        this.backgroundContainer,\r\n        this.actionButton\r\n    ];\r\n}","/**\r\n * Build and return formatting descriptor for simple slice\r\n *\r\n * @param objectName Object name from capabilities\r\n * @param slice formatting simple slice\r\n * @returns simple slice formatting descriptor\r\n */\r\nexport function getDescriptor(objectName, slice) {\r\n    return {\r\n        objectName: objectName,\r\n        propertyName: slice.name,\r\n        selector: slice.selector,\r\n        altConstantValueSelector: slice.altConstantSelector,\r\n        instanceKind: slice.instanceKind\r\n    };\r\n}\r\n/**\r\n * Get property value from dataview objects if exists\r\n * Else return the default value from formatting settings object\r\n *\r\n * @param value dataview object value\r\n * @param defaultValue formatting settings default value\r\n * @returns formatting property value\r\n */\r\nexport function getPropertyValue(slice, value, defaultValue) {\r\n    if (value == null || (typeof value === \"object\" && !value.solid)) {\r\n        return defaultValue;\r\n    }\r\n    if (value.solid) {\r\n        return { value: value === null || value === void 0 ? void 0 : value.solid.color };\r\n    }\r\n    if (slice === null || slice === void 0 ? void 0 : slice.items) {\r\n        let itemsArray = slice.items;\r\n        return itemsArray.find(item => item.value == value);\r\n    }\r\n    return value;\r\n}\r\n//# sourceMappingURL=FormattingSettingsUtils.js.map","import { CompositeCard, SimpleCard } from \"./FormattingSettingsComponents\";\r\nexport class FormattingSettingsService {\r\n    constructor(localizationManager) {\r\n        this.localizationManager = localizationManager;\r\n    }\r\n    /**\r\n     * Build visual formatting settings model from metadata dataView\r\n     *\r\n     * @param dataViews metadata dataView object\r\n     * @returns visual formatting settings model\r\n     */\r\n    populateFormattingSettingsModel(typeClass, dataView) {\r\n        var _a, _b;\r\n        let defaultSettings = new typeClass();\r\n        let dataViewObjects = (_a = dataView === null || dataView === void 0 ? void 0 : dataView.metadata) === null || _a === void 0 ? void 0 : _a.objects;\r\n        if (dataViewObjects) {\r\n            // loop over each formatting property and set its new value if exists\r\n            (_b = defaultSettings.cards) === null || _b === void 0 ? void 0 : _b.forEach((card) => {\r\n                var _a;\r\n                if (card instanceof CompositeCard)\r\n                    (_a = card.topLevelSlice) === null || _a === void 0 ? void 0 : _a.setPropertiesValues(dataViewObjects, card.name);\r\n                const cardGroupInstances = (card instanceof SimpleCard ? [card] : card.groups);\r\n                cardGroupInstances.forEach((cardGroupInstance) => {\r\n                    var _a, _b, _c, _d;\r\n                    // Set current top level toggle value\r\n                    (_a = cardGroupInstance.topLevelSlice) === null || _a === void 0 ? void 0 : _a.setPropertiesValues(dataViewObjects, card.name);\r\n                    (_b = cardGroupInstance === null || cardGroupInstance === void 0 ? void 0 : cardGroupInstance.slices) === null || _b === void 0 ? void 0 : _b.forEach((slice) => {\r\n                        slice === null || slice === void 0 ? void 0 : slice.setPropertiesValues(dataViewObjects, card.name);\r\n                    });\r\n                    (_d = (_c = cardGroupInstance === null || cardGroupInstance === void 0 ? void 0 : cardGroupInstance.container) === null || _c === void 0 ? void 0 : _c.containerItems) === null || _d === void 0 ? void 0 : _d.forEach((containerItem) => {\r\n                        var _a;\r\n                        (_a = containerItem === null || containerItem === void 0 ? void 0 : containerItem.slices) === null || _a === void 0 ? void 0 : _a.forEach((slice) => {\r\n                            slice === null || slice === void 0 ? void 0 : slice.setPropertiesValues(dataViewObjects, card.name);\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        }\r\n        return defaultSettings;\r\n    }\r\n    /**\r\n     * Build formatting model by parsing formatting settings model object\r\n     *\r\n     * @returns powerbi visual formatting model\r\n     */\r\n    buildFormattingModel(formattingSettingsModel) {\r\n        let formattingModel = {\r\n            cards: []\r\n        };\r\n        formattingSettingsModel.cards\r\n            .filter(({ visible = true }) => visible)\r\n            .forEach((card) => {\r\n            var _a;\r\n            let formattingCard = {\r\n                displayName: (this.localizationManager && card.displayNameKey) ? this.localizationManager.getDisplayName(card.displayNameKey) : card.displayName,\r\n                description: (this.localizationManager && card.descriptionKey) ? this.localizationManager.getDisplayName(card.descriptionKey) : card.description,\r\n                groups: [],\r\n                uid: card.name + \"-card\",\r\n                analyticsPane: card.analyticsPane,\r\n            };\r\n            const objectName = card.name;\r\n            if (card.topLevelSlice) {\r\n                let topLevelToggleSlice = card.topLevelSlice.getFormattingSlice(objectName, this.localizationManager);\r\n                topLevelToggleSlice.suppressDisplayName = true;\r\n                formattingCard.topLevelToggle = topLevelToggleSlice;\r\n            }\r\n            (_a = card.onPreProcess) === null || _a === void 0 ? void 0 : _a.call(card);\r\n            const isSimpleCard = card instanceof SimpleCard;\r\n            const cardGroupInstances = (isSimpleCard ?\r\n                [card].filter(({ visible = true }) => visible) :\r\n                card.groups.filter(({ visible = true }) => visible));\r\n            cardGroupInstances\r\n                .forEach((cardGroupInstance) => {\r\n                const groupUid = cardGroupInstance.name + \"-group\";\r\n                // Build formatting group for each group\r\n                const formattingGroup = {\r\n                    displayName: isSimpleCard ? undefined : (this.localizationManager && cardGroupInstance.displayNameKey)\r\n                        ? this.localizationManager.getDisplayName(cardGroupInstance.displayNameKey) : cardGroupInstance.displayName,\r\n                    description: isSimpleCard ? undefined : (this.localizationManager && cardGroupInstance.descriptionKey)\r\n                        ? this.localizationManager.getDisplayName(cardGroupInstance.descriptionKey) : cardGroupInstance.description,\r\n                    slices: [],\r\n                    uid: groupUid,\r\n                    collapsible: cardGroupInstance.collapsible,\r\n                    delaySaveSlices: cardGroupInstance.delaySaveSlices,\r\n                    disabled: cardGroupInstance.disabled,\r\n                    disabledReason: cardGroupInstance.disabledReason,\r\n                };\r\n                formattingCard.groups.push(formattingGroup);\r\n                // In case formatting model adds data points or top categories (Like when you modify specific visual category color).\r\n                // these categories use same object name and property name from capabilities and the generated uid will be the same for these formatting categories properties\r\n                // Solution => Save slice names to modify each slice uid to be unique by adding counter value to the new slice uid\r\n                const sliceNames = {};\r\n                // Build formatting container slice for each property\r\n                if (cardGroupInstance.container) {\r\n                    const container = cardGroupInstance.container;\r\n                    const containerUid = groupUid + \"-container\";\r\n                    const formattingContainer = {\r\n                        displayName: (this.localizationManager && container.displayNameKey)\r\n                            ? this.localizationManager.getDisplayName(container.displayNameKey) : container.displayName,\r\n                        description: (this.localizationManager && container.descriptionKey)\r\n                            ? this.localizationManager.getDisplayName(container.descriptionKey) : container.description,\r\n                        containerItems: [],\r\n                        uid: containerUid\r\n                    };\r\n                    container.containerItems.forEach((containerItem) => {\r\n                        // Build formatting container item object\r\n                        const containerIemName = containerItem.displayNameKey ? containerItem.displayNameKey : containerItem.displayName;\r\n                        const containerItemUid = containerUid + containerIemName;\r\n                        let formattingContainerItem = {\r\n                            displayName: (this.localizationManager && containerItem.displayNameKey)\r\n                                ? this.localizationManager.getDisplayName(containerItem.displayNameKey) : containerItem.displayName,\r\n                            slices: [],\r\n                            uid: containerItemUid\r\n                        };\r\n                        // Build formatting slices and add them to current formatting container item\r\n                        this.buildFormattingSlices({ slices: containerItem.slices, objectName, sliceNames, formattingSlices: formattingContainerItem.slices });\r\n                        formattingContainer.containerItems.push(formattingContainerItem);\r\n                    });\r\n                    formattingGroup.container = formattingContainer;\r\n                }\r\n                if (cardGroupInstance.slices) {\r\n                    if (cardGroupInstance.topLevelSlice) {\r\n                        let topLevelToggleSlice = cardGroupInstance.topLevelSlice.getFormattingSlice(objectName, this.localizationManager);\r\n                        topLevelToggleSlice.suppressDisplayName = true;\r\n                        (formattingGroup.displayName == undefined ? formattingCard : formattingGroup).topLevelToggle = topLevelToggleSlice;\r\n                    }\r\n                    // Build formatting slice for each property\r\n                    this.buildFormattingSlices({ slices: cardGroupInstance.slices, objectName, sliceNames, formattingSlices: formattingGroup.slices });\r\n                }\r\n            });\r\n            formattingCard.revertToDefaultDescriptors = this.getRevertToDefaultDescriptor(card);\r\n            formattingModel.cards.push(formattingCard);\r\n        });\r\n        return formattingModel;\r\n    }\r\n    buildFormattingSlices({ slices, objectName, sliceNames, formattingSlices }) {\r\n        // Filter slices based on their visibility\r\n        slices === null || slices === void 0 ? void 0 : slices.filter(({ visible = true }) => visible).forEach((slice) => {\r\n            let formattingSlice = slice === null || slice === void 0 ? void 0 : slice.getFormattingSlice(objectName, this.localizationManager);\r\n            if (formattingSlice) {\r\n                // Modify formatting slice uid if needed\r\n                if (sliceNames[slice.name] === undefined) {\r\n                    sliceNames[slice.name] = 0;\r\n                }\r\n                else {\r\n                    sliceNames[slice.name]++;\r\n                    formattingSlice.uid = `${formattingSlice.uid}-${sliceNames[slice.name]}`;\r\n                }\r\n                formattingSlices.push(formattingSlice);\r\n            }\r\n        });\r\n    }\r\n    getRevertToDefaultDescriptor(card) {\r\n        var _a;\r\n        // Proceeded slice names are saved to prevent duplicated default descriptors in case of using \r\n        // formatting categories & selectors, since they have the same descriptor objectName and propertyName\r\n        const sliceNames = {};\r\n        let revertToDefaultDescriptors = [];\r\n        let cardSlicesDefaultDescriptors;\r\n        let cardContainerSlicesDefaultDescriptors = [];\r\n        if (card instanceof CompositeCard && card.topLevelSlice)\r\n            revertToDefaultDescriptors.push(...(_a = card.topLevelSlice) === null || _a === void 0 ? void 0 : _a.getRevertToDefaultDescriptor(card.name));\r\n        const cardGroupInstances = (card instanceof SimpleCard ?\r\n            [card].filter(({ visible = true }) => visible) :\r\n            card.groups.filter(({ visible = true }) => visible));\r\n        cardGroupInstances.forEach((cardGroupInstance) => {\r\n            var _a, _b;\r\n            cardSlicesDefaultDescriptors = this.getSlicesRevertToDefaultDescriptor(card.name, cardGroupInstance.slices, sliceNames, cardGroupInstance.topLevelSlice);\r\n            (_b = (_a = cardGroupInstance.container) === null || _a === void 0 ? void 0 : _a.containerItems) === null || _b === void 0 ? void 0 : _b.forEach((containerItem) => {\r\n                cardContainerSlicesDefaultDescriptors = cardContainerSlicesDefaultDescriptors.concat(this.getSlicesRevertToDefaultDescriptor(card.name, containerItem.slices, sliceNames));\r\n            });\r\n            revertToDefaultDescriptors.push(...cardSlicesDefaultDescriptors.concat(cardContainerSlicesDefaultDescriptors));\r\n        });\r\n        return revertToDefaultDescriptors;\r\n    }\r\n    getSlicesRevertToDefaultDescriptor(cardName, slices, sliceNames, topLevelSlice) {\r\n        let revertToDefaultDescriptors = [];\r\n        if (topLevelSlice) {\r\n            sliceNames[topLevelSlice.name] = true;\r\n            revertToDefaultDescriptors = revertToDefaultDescriptors.concat(topLevelSlice.getRevertToDefaultDescriptor(cardName));\r\n        }\r\n        slices === null || slices === void 0 ? void 0 : slices.forEach((slice) => {\r\n            if (slice && !sliceNames[slice.name]) {\r\n                sliceNames[slice.name] = true;\r\n                revertToDefaultDescriptors = revertToDefaultDescriptors.concat(slice.getRevertToDefaultDescriptor(cardName));\r\n            }\r\n        });\r\n        return revertToDefaultDescriptors;\r\n    }\r\n}\r\nexport default FormattingSettingsService;\r\n//# sourceMappingURL=FormattingSettingsService.js.map","import * as formattingSettings from \"./FormattingSettingsComponents\";\r\nimport FormattingSettingsService from \"./FormattingSettingsService\";\r\nexport { formattingSettings, FormattingSettingsService };\r\n//# sourceMappingURL=index.js.map","/**\r\n * Powerbi utils components classes for custom visual formatting pane objects\r\n *\r\n */\r\nimport * as FormattingSettingsParser from \"./utils/FormattingSettingsUtils\";\r\nclass NamedEntity {\r\n}\r\nexport class CardGroupEntity extends NamedEntity {\r\n}\r\nexport class Model {\r\n}\r\n/** CompositeCard is use to populate a card into the formatting pane with multiple groups */\r\nexport class CompositeCard extends NamedEntity {\r\n}\r\nexport class Group extends CardGroupEntity {\r\n    constructor(object) {\r\n        super();\r\n        Object.assign(this, object);\r\n    }\r\n}\r\n/** SimpleCard is use to populate a card into the formatting pane in a single group */\r\nexport class SimpleCard extends CardGroupEntity {\r\n}\r\nexport class SimpleSlice extends NamedEntity {\r\n    constructor(object) {\r\n        super();\r\n        Object.assign(this, object);\r\n    }\r\n    getFormattingSlice(objectName, localizationManager) {\r\n        const controlType = this.type;\r\n        const propertyName = this.name;\r\n        const sliceDisplayName = (localizationManager && this.displayNameKey) ? localizationManager.getDisplayName(this.displayNameKey) : this.displayName;\r\n        const sliceDescription = (localizationManager && this.descriptionKey) ? localizationManager.getDisplayName(this.descriptionKey) : this.description;\r\n        const componentDisplayName = {\r\n            displayName: sliceDisplayName,\r\n            description: sliceDescription,\r\n            uid: objectName + '-' + propertyName,\r\n        };\r\n        return Object.assign(Object.assign({}, componentDisplayName), { control: {\r\n                type: controlType,\r\n                properties: this.getFormattingComponent(objectName, localizationManager)\r\n            } });\r\n    }\r\n    getFormattingComponent(objectName, localizationManager) {\r\n        return {\r\n            descriptor: FormattingSettingsParser.getDescriptor(objectName, this),\r\n            value: this.value,\r\n        };\r\n    }\r\n    getRevertToDefaultDescriptor(objectName) {\r\n        return [{\r\n                objectName: objectName,\r\n                propertyName: this.name\r\n            }];\r\n    }\r\n    setPropertiesValues(dataViewObjects, objectName) {\r\n        var _a;\r\n        let newValue = (_a = dataViewObjects === null || dataViewObjects === void 0 ? void 0 : dataViewObjects[objectName]) === null || _a === void 0 ? void 0 : _a[this.name];\r\n        this.value = FormattingSettingsParser.getPropertyValue(this, newValue, this.value);\r\n    }\r\n}\r\nexport class AlignmentGroup extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"AlignmentGroup\" /* visuals.FormattingComponent.AlignmentGroup */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { mode: this.mode, supportsNoSelection: this.supportsNoSelection });\r\n    }\r\n}\r\nexport class ToggleSwitch extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"ToggleSwitch\" /* visuals.FormattingComponent.ToggleSwitch */;\r\n    }\r\n}\r\nexport class ColorPicker extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"ColorPicker\" /* visuals.FormattingComponent.ColorPicker */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { defaultColor: this.defaultColor, isNoFillItemSupported: this.isNoFillItemSupported });\r\n    }\r\n}\r\nexport class NumUpDown extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"NumUpDown\" /* visuals.FormattingComponent.NumUpDown */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { options: this.options });\r\n    }\r\n}\r\nexport class Slider extends NumUpDown {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"Slider\" /* visuals.FormattingComponent.Slider */;\r\n    }\r\n}\r\nexport class DatePicker extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"DatePicker\" /* visuals.FormattingComponent.DatePicker */;\r\n    }\r\n    getFormattingComponent(objectName, localizationManager) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { placeholder: (localizationManager && this.placeholderKey) ? localizationManager.getDisplayName(this.placeholderKey) : this.placeholder, validators: this.validators });\r\n    }\r\n}\r\nexport class ItemDropdown extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"Dropdown\" /* visuals.FormattingComponent.Dropdown */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { items: this.items });\r\n    }\r\n}\r\nexport class AutoDropdown extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"Dropdown\" /* visuals.FormattingComponent.Dropdown */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { mergeValues: this.mergeValues, filterValues: this.filterValues });\r\n    }\r\n}\r\nexport class DurationPicker extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"DurationPicker\" /* visuals.FormattingComponent.DurationPicker */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { validators: this.validators });\r\n    }\r\n}\r\nexport class ErrorRangeControl extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"ErrorRangeControl\" /* visuals.FormattingComponent.ErrorRangeControl */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { validators: this.validators });\r\n    }\r\n}\r\nexport class FieldPicker extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"FieldPicker\" /* visuals.FormattingComponent.FieldPicker */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { validators: this.validators, allowMultipleValues: this.allowMultipleValues });\r\n    }\r\n}\r\nexport class ItemFlagsSelection extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"FlagsSelection\" /* visuals.FormattingComponent.FlagsSelection */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { items: this.items });\r\n    }\r\n}\r\nexport class AutoFlagsSelection extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"FlagsSelection\" /* visuals.FormattingComponent.FlagsSelection */;\r\n    }\r\n}\r\nexport class TextInput extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"TextInput\" /* visuals.FormattingComponent.TextInput */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { placeholder: this.placeholder });\r\n    }\r\n}\r\nexport class TextArea extends TextInput {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"TextArea\" /* visuals.FormattingComponent.TextArea */;\r\n    }\r\n}\r\nexport class FontPicker extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"FontPicker\" /* visuals.FormattingComponent.FontPicker */;\r\n    }\r\n}\r\nexport class GradientBar extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"GradientBar\" /* visuals.FormattingComponent.GradientBar */;\r\n    }\r\n}\r\nexport class ImageUpload extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"ImageUpload\" /* visuals.FormattingComponent.ImageUpload */;\r\n    }\r\n}\r\nexport class ListEditor extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"ListEditor\" /* visuals.FormattingComponent.ListEditor */;\r\n    }\r\n}\r\nexport class ReadOnlyText extends SimpleSlice {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = \"ReadOnlyText\" /* visuals.FormattingComponent.ReadOnlyText */;\r\n    }\r\n}\r\nexport class ShapeMapSelector extends SimpleSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"ShapeMapSelector\" /* visuals.FormattingComponent.ShapeMapSelector */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return Object.assign(Object.assign({}, super.getFormattingComponent(objectName)), { isAzMapReferenceSelector: this.isAzMapReferenceSelector });\r\n    }\r\n}\r\nexport class CompositeSlice extends NamedEntity {\r\n    constructor(object) {\r\n        super();\r\n        Object.assign(this, object);\r\n    }\r\n    getFormattingSlice(objectName, localizationManager) {\r\n        const controlType = this.type;\r\n        const propertyName = this.name;\r\n        const componentDisplayName = {\r\n            displayName: (localizationManager && this.displayNameKey) ? localizationManager.getDisplayName(this.displayNameKey) : this.displayName,\r\n            description: (localizationManager && this.descriptionKey) ? localizationManager.getDisplayName(this.descriptionKey) : this.description,\r\n            uid: objectName + '-' + propertyName,\r\n        };\r\n        return Object.assign(Object.assign({}, componentDisplayName), { control: {\r\n                type: controlType,\r\n                properties: this.getFormattingComponent(objectName)\r\n            } });\r\n    }\r\n}\r\nexport class FontControl extends CompositeSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"FontControl\" /* visuals.FormattingComponent.FontControl */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        var _a, _b, _c;\r\n        return {\r\n            fontFamily: this.fontFamily.getFormattingComponent(objectName),\r\n            fontSize: this.fontSize.getFormattingComponent(objectName),\r\n            bold: (_a = this.bold) === null || _a === void 0 ? void 0 : _a.getFormattingComponent(objectName),\r\n            italic: (_b = this.italic) === null || _b === void 0 ? void 0 : _b.getFormattingComponent(objectName),\r\n            underline: (_c = this.underline) === null || _c === void 0 ? void 0 : _c.getFormattingComponent(objectName)\r\n        };\r\n    }\r\n    getRevertToDefaultDescriptor(objectName) {\r\n        return this.fontFamily.getRevertToDefaultDescriptor(objectName)\r\n            .concat(this.fontSize.getRevertToDefaultDescriptor(objectName))\r\n            .concat(this.bold ? this.bold.getRevertToDefaultDescriptor(objectName) : [])\r\n            .concat(this.italic ? this.italic.getRevertToDefaultDescriptor(objectName) : [])\r\n            .concat(this.underline ? this.underline.getRevertToDefaultDescriptor(objectName) : []);\r\n    }\r\n    setPropertiesValues(dataViewObjects, objectName) {\r\n        var _a, _b, _c;\r\n        this.fontFamily.setPropertiesValues(dataViewObjects, objectName);\r\n        this.fontSize.setPropertiesValues(dataViewObjects, objectName);\r\n        (_a = this.bold) === null || _a === void 0 ? void 0 : _a.setPropertiesValues(dataViewObjects, objectName);\r\n        (_b = this.italic) === null || _b === void 0 ? void 0 : _b.setPropertiesValues(dataViewObjects, objectName);\r\n        (_c = this.underline) === null || _c === void 0 ? void 0 : _c.setPropertiesValues(dataViewObjects, objectName);\r\n    }\r\n}\r\nexport class MarginPadding extends CompositeSlice {\r\n    constructor(object) {\r\n        super(object);\r\n        this.type = \"MarginPadding\" /* visuals.FormattingComponent.MarginPadding */;\r\n    }\r\n    getFormattingComponent(objectName) {\r\n        return {\r\n            left: this.left.getFormattingComponent(objectName),\r\n            right: this.right.getFormattingComponent(objectName),\r\n            top: this.top.getFormattingComponent(objectName),\r\n            bottom: this.bottom.getFormattingComponent(objectName)\r\n        };\r\n    }\r\n    getRevertToDefaultDescriptor(objectName) {\r\n        return this.left.getRevertToDefaultDescriptor(objectName)\r\n            .concat(this.right.getRevertToDefaultDescriptor(objectName))\r\n            .concat(this.top.getRevertToDefaultDescriptor(objectName))\r\n            .concat(this.bottom.getRevertToDefaultDescriptor(objectName));\r\n    }\r\n    setPropertiesValues(dataViewObjects, objectName) {\r\n        this.left.setPropertiesValues(dataViewObjects, objectName);\r\n        this.right.setPropertiesValues(dataViewObjects, objectName);\r\n        this.top.setPropertiesValues(dataViewObjects, objectName);\r\n        this.bottom.setPropertiesValues(dataViewObjects, objectName);\r\n    }\r\n}\r\nexport class Container extends NamedEntity {\r\n    constructor(object) {\r\n        super();\r\n        Object.assign(this, object);\r\n    }\r\n}\r\nexport class ContainerItem extends NamedEntity {\r\n}\r\n//# sourceMappingURL=FormattingSettingsComponents.js.map","\"use strict\";\r\n\r\nimport powerbi from \"powerbi-visuals-api\";\r\nimport VisualConstructorOptions = powerbi.extensibility.visual.VisualConstructorOptions;\r\nimport VisualUpdateOptions = powerbi.extensibility.visual.VisualUpdateOptions;\r\nimport IVisual = powerbi.extensibility.visual.IVisual;\r\nimport IVisualHost = powerbi.extensibility.visual.IVisualHost;\r\n\r\n// Importation des types pour la gestion des licences (API 4.7+)\r\nimport IVisualLicenseManager = powerbi.extensibility.IVisualLicenseManager;\r\nimport LicenseInfoResult = powerbi.extensibility.visual.LicenseInfoResult;\r\nimport ServicePlan = powerbi.extensibility.visual.ServicePlan;\r\nimport ServicePlanState = powerbi.ServicePlanState;\r\nimport LicenseNotificationType = powerbi.LicenseNotificationType;\r\n\r\n// Importation du Service de formatage (FormattingSettingsService)\r\nimport { formattingSettings, FormattingSettingsService } from \"powerbi-visuals-utils-formattingmodel\";\r\nimport { VisualFormattingSettingsModel, ManualLineSettings } from \"./settings\";\r\n\r\nimport \"../style/visual.less\";\r\nconst DEV_MODE = true // Passez  false pour la prod\r\ninterface RowData {\r\n    originalName: string;\r\n    label: string;\r\n    amount: string;\r\n    columnIndex: number;\r\n    sortIndex: number;\r\n    \r\n    marginBottom: number;\r\n    marginTop: number;\r\n    marginColor: string;\r\n    isHidden: boolean;\r\n    isHeader: boolean;\r\n    \r\n    isVirtual: boolean;\r\n\r\n    font: string; fontSize: number;\r\n    bgLabel: string; colorLabel: string; boldLabel: boolean; italicLabel: boolean;\r\n    bgAmount: string; colorAmount: string; boldAmount: boolean;\r\n    \r\n    customAmount: string;\r\n    customLabel?: string;\r\n    \r\n    // Bordures compltes (4 cts)\r\n    borderWidth: number;\r\n    borderColor: string;\r\n}\r\n\r\nexport class Visual implements IVisual {\r\n    private target: HTMLElement;\r\n    private host: IVisualHost;\r\n    private divContainer: HTMLDivElement;\r\n    private flexContainer: HTMLDivElement;\r\n    \r\n    private allRowsData: RowData[] = [];\r\n    private categoricalData: any;\r\n    private currentSelectedLabel: string = \"\"; \r\n    private columnTitles: string[] = [];\r\n    private metadata: any;\r\n    private toolbar: HTMLDivElement;\r\n    \r\n    private pendingChanges: Map<string, any> = new Map();\r\n    private manualLineKeys: string[] = [];\r\n    \r\n    private areActionButtonsVisible: boolean = false;\r\n    private selectionManager: powerbi.extensibility.ISelectionManager;\r\n\r\n    // Bordures globales du tableau\r\n    private tableBorderWidth: number = 1;\r\n    private tableBorderColor: string = \"rgba(0, 0, 0, 0.25)\";\r\n    private tableBorderStyle: string = \"solid\";\r\n    private tableBorderRadius: number = 8;\r\n\r\n    // Modle de formatage (API 5.1)\r\n    private formattingSettings: VisualFormattingSettingsModel;\r\n    // Service de formatage (Ncessaire pour buildFormattingModel)\r\n    private formattingSettingsService: FormattingSettingsService;\r\n\r\n    // License related properties\r\n    private licenseManager: IVisualLicenseManager;\r\n    private currentUserValidPlans: ServicePlan[] | undefined;\r\n    private hasServicePlans: boolean | undefined;\r\n    private isLicenseUnsupportedEnv: boolean | undefined;\r\n    private isLicenseInfoAvailable: boolean | undefined;\r\n\r\n    // Helper centralis pour persister les proprits d'une ligne (merge safe + logs)\r\n    private persistStyle(selector: any, properties: any, objectName: string = \"styleLigne\") {\r\n        // nettoyer les cls undefined\r\n        Object.keys(properties || {}).forEach(k => { if (properties[k] === undefined) delete properties[k]; });\r\n        try {\r\n            // eslint-disable-next-line no-console\r\n            console.log(\"PERSIST STYLE -> object:\", objectName, \"selector:\", selector, \"props:\", properties);\r\n            this.host.persistProperties({\r\n                merge: [{\r\n                    objectName: objectName,\r\n                    selector: selector,\r\n                    properties: properties\r\n                }]\r\n            });\r\n            // eslint-disable-next-line no-console\r\n            console.log(\"PERSIST STYLE OK ->\", objectName);\r\n        } catch (err) {\r\n            // eslint-disable-next-line no-console\r\n            console.error(\"PERSIST STYLE ERROR:\", err);\r\n        }\r\n    }\r\n\r\n    private handleLicenseNotification() {\r\n        if (DEV_MODE) return; // Dsactive tout en dev\r\n        if (this.isLicenseUnsupportedEnv) {\r\n             this.licenseManager.notifyLicenseRequired(LicenseNotificationType.UnsupportedEnv);\r\n        } else if (!this.hasServicePlans) {\r\n             this.licenseManager.notifyLicenseRequired(LicenseNotificationType.VisualIsBlocked);\r\n        }\r\n    }\r\n\r\n    constructor(options: VisualConstructorOptions) {\r\n        this.host = options.host;\r\n        this.target = options.element;\r\n        \r\n        // Initialisation du service de formatage\r\n        this.formattingSettingsService = new FormattingSettingsService();\r\n\r\n        // License Management\r\n        this.licenseManager = options.host.licenseManager;\r\n        \r\n        this.licenseManager.getAvailableServicePlans()\r\n            .then((result: LicenseInfoResult) => {\r\n                this.isLicenseUnsupportedEnv = result.isLicenseUnsupportedEnv;\r\n                this.isLicenseInfoAvailable = result.isLicenseInfoAvailable;\r\n\r\n                if (this.isLicenseInfoAvailable && !this.isLicenseUnsupportedEnv) {\r\n                    this.currentUserValidPlans = result.plans?.filter((plan: ServicePlan) => \r\n                        // OPTIONNEL : Si vous voulez restreindre  un plan spcifique dfini dans l'Espace Partenaires\r\n                        // (plan.spIdentifier === \"mon_id_de_plan_partner_center\") &&\r\n                        (plan.state === ServicePlanState.Active || plan.state === ServicePlanState.Warning)\r\n                    );\r\n                    this.hasServicePlans = !!this.currentUserValidPlans?.length;\r\n                }\r\n\r\n                this.handleLicenseNotification();\r\n            })\r\n            .catch((err) => {\r\n                console.error(\"License check failed:\", err);\r\n                this.currentUserValidPlans = undefined;\r\n                this.hasServicePlans = undefined;\r\n            });\r\n        \r\n        // Initialisation du gestionnaire de slection pour les menus contextuels\r\n        this.selectionManager = this.host.createSelectionManager();\r\n        \r\n        // Initialisation du gestionnaire de slection pour les menus contextuels\r\n        this.selectionManager = this.host.createSelectionManager();\r\n\r\n        this.divContainer = document.createElement(\"div\");\r\n        this.divContainer.className = \"scroll-wrapper\";\r\n        this.target.appendChild(this.divContainer);\r\n        this.flexContainer = document.createElement(\"div\");\r\n        this.flexContainer.className = \"accounting-container\";\r\n        this.divContainer.appendChild(this.flexContainer);\r\n\r\n        this.toolbar = document.createElement(\"div\");\r\n        this.toolbar.className = \"floating-toolbar\";\r\n        this.toolbar.style.display = \"none\";\r\n        document.body.appendChild(this.toolbar);\r\n        \r\n        document.addEventListener(\"mousedown\", (e) => {\r\n            if (this.toolbar.style.display !== \"none\" && \r\n                !this.toolbar.contains(e.target as Node)) {\r\n                this.toolbar.style.display = \"none\";\r\n            }\r\n        });\r\n    }\r\n\r\n    public update(options: VisualUpdateOptions) {\r\n        // Initialiser et remplir le modle de formatage depuis Power BI\r\n        if (options.dataViews && options.dataViews[0]) {\r\n            this.formattingSettings = this.formattingSettingsService.populateFormattingSettingsModel(\r\n                VisualFormattingSettingsModel,\r\n                options.dataViews[0]\r\n            );\r\n            this.metadata = options.dataViews[0].metadata;\r\n        }\r\n\r\n        // Utiliser la valeur du toggle du modle de formatage\r\n        let showActionButton = true;\r\n        if (this.formattingSettings && this.formattingSettings.actionButton && typeof this.formattingSettings.actionButton.show.value === \"boolean\") {\r\n            showActionButton = this.formattingSettings.actionButton.show.value;\r\n        }\r\n\r\n        // Si le bouton d'action est masqu, on retire tout le padding et on force la hauteur  100%\r\n        if (!showActionButton) {\r\n            this.divContainer.style.padding = \"0\";\r\n            this.divContainer.style.margin = \"0\";\r\n            this.divContainer.style.height = \"100%\";\r\n            this.flexContainer.style.height = \"100%\";\r\n        } else {\r\n            this.divContainer.style.padding = \"5px\";\r\n            this.divContainer.style.margin = \"\";\r\n            this.divContainer.style.height = \"\";\r\n            this.flexContainer.style.height = \"\";\r\n        }\r\n\r\n\r\n        // Nettoyage scuris\r\n        while (this.flexContainer.firstChild) {\r\n            this.flexContainer.removeChild(this.flexContainer.firstChild);\r\n        }\r\n\r\n        this.allRowsData = [];\r\n        this.manualLineKeys = [];\r\n\r\n        const dataView = options.dataViews[0];\r\n        this.metadata = dataView ? dataView.metadata : null;\r\n        this.categoricalData = dataView && dataView.categorical ? dataView.categorical : null;\r\n\r\n        // Charger la couleur de fond du conteneur principal (autour du tableau)\r\n        let containerBg = \"#fff\";\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"backgroundContainer\"] && this.metadata.objects[\"backgroundContainer\"][\"color\"]) {\r\n            const bgObj = this.metadata.objects[\"backgroundContainer\"][\"color\"];\r\n            if (bgObj && bgObj.solid && bgObj.solid.color) {\r\n                containerBg = bgObj.solid.color;\r\n            }\r\n        }\r\n        this.divContainer.style.background = containerBg;\r\n        // Le fond du tableau reste gr par le CSS (toujours blanc)\r\n\r\n        // Charger les bordures globales du tableau\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"tableBorders\"]) {\r\n            const tb = this.metadata.objects[\"tableBorders\"];\r\n            if (tb[\"borderWidth\"] !== undefined) this.tableBorderWidth = tb[\"borderWidth\"] as number;\r\n            if (tb[\"borderColor\"]) this.tableBorderColor = (tb[\"borderColor\"] as any).solid.color;\r\n            if (tb[\"borderStyle\"]) this.tableBorderStyle = tb[\"borderStyle\"] as string;\r\n            if (tb[\"borderRadius\"] !== undefined) this.tableBorderRadius = tb[\"borderRadius\"] as number;\r\n        }\r\n\r\n        console.log(\" BORDURES CHARGES:\", {\r\n            width: this.tableBorderWidth,\r\n            color: this.tableBorderColor,\r\n            style: this.tableBorderStyle,\r\n            radius: this.tableBorderRadius\r\n        });\r\n\r\n        // 1. TITRES - Initialisation dynamique\r\n        this.columnTitles = [];\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"titresColonnes\"]) {\r\n            const t = this.metadata.objects[\"titresColonnes\"];\r\n            for (let i = 1; i <= 20; i++) {\r\n                const key = \"titre\" + i;\r\n                if (t[key]) {\r\n                    this.columnTitles[i-1] = t[key] as string;\r\n                }\r\n            }\r\n        }\r\n\r\n        // 2. DONNES EXCEL\r\n        let maxColumnIndexUsed = 1;\r\n        \r\n        if (this.categoricalData) {\r\n            const categories = this.categoricalData.categories[0];\r\n            const values = this.categoricalData.values ? this.categoricalData.values[0] : null;\r\n\r\n            if (this.metadata && this.metadata.objects && this.metadata.objects[\"selectionMenu\"]) {\r\n                this.currentSelectedLabel = this.metadata.objects[\"selectionMenu\"][\"ligneActive\"] as string;\r\n            }\r\n            if (!this.currentSelectedLabel && categories.values.length > 0) {\r\n                this.currentSelectedLabel = categories.values[0].toString();\r\n            }\r\n\r\n            categories.values.forEach((catValue, index) => {\r\n                const originalName = catValue.toString();\r\n                let row: RowData = {\r\n                    originalName: originalName,\r\n                    label: originalName,\r\n                    amount: values ? values.values[index]?.toString() : \"\",\r\n                    columnIndex: 1, sortIndex: index * 10,\r\n                    marginBottom: 0, marginTop: 0, isHidden: false, marginColor: \"transparent\",\r\n                    isHeader: false, isVirtual: false, customAmount: \"\",\r\n                    font: \"'Segoe UI', sans-serif\", fontSize: 12,\r\n                    bgLabel: \"transparent\", colorLabel: \"black\", boldLabel: false, italicLabel: false,\r\n                    bgAmount: \"transparent\", colorAmount: \"black\", boldAmount: false,\r\n                    borderWidth: 1,\r\n                    borderColor: \"#eee\"\r\n                };\r\n\r\n                if (categories.objects && categories.objects[index]) {\r\n                    const object = categories.objects[index];\r\n                    if (object[\"styleLigne\"]) {\r\n                        const style = object[\"styleLigne\"];\r\n                        if (style[\"columnIndex\"]) row.columnIndex = style[\"columnIndex\"] as number;\r\n                        if (row.columnIndex < 1) row.columnIndex = 1;\r\n                        if (style[\"ordreTri\"] !== undefined) row.sortIndex = style[\"ordreTri\"] as number;\r\n                        \r\n                        if (style[\"marginBottom\"] !== undefined) row.marginBottom = style[\"marginBottom\"] as number;\r\n                        if (style[\"marginTop\"] !== undefined) row.marginTop = style[\"marginTop\"] as number;\r\n                        if (style[\"isHidden\"]) row.isHidden = style[\"isHidden\"] as boolean;\r\n                        if (style[\"marginColor\"]) row.marginColor = (style[\"marginColor\"] as any).solid.color;\r\n                        if (style[\"customLabel\"]) row.label = style[\"customLabel\"] as string;\r\n                        if (style[\"customAmount\"]) row.customAmount = style[\"customAmount\"] as string;\r\n                        if (style[\"isHeader\"]) row.isHeader = style[\"isHeader\"] as boolean;\r\n                        if (style[\"fontSize\"]) row.fontSize = style[\"fontSize\"] as number;\r\n                        if (style[\"fontFamily\"]) row.font = style[\"fontFamily\"] as string;\r\n                        if (style[\"bgLabel\"]) row.bgLabel = (style[\"bgLabel\"] as any).solid.color;\r\n                        if (style[\"fillLabel\"]) row.colorLabel = (style[\"fillLabel\"] as any).solid.color;\r\n                        if (style[\"boldLabel\"] !== undefined) row.boldLabel = style[\"boldLabel\"] as boolean;\r\n                        if (style[\"italicLabel\"] !== undefined) row.italicLabel = style[\"italicLabel\"] as boolean;\r\n                        if (style[\"bgAmount\"]) row.bgAmount = (style[\"bgAmount\"] as any).solid.color;\r\n                        if (style[\"fillAmount\"]) row.colorAmount = (style[\"fillAmount\"] as any).solid.color;\r\n                        if (style[\"boldAmount\"] !== undefined) row.boldAmount = style[\"boldAmount\"] as boolean;\r\n\r\n                        if (style[\"borderWidth\"] !== undefined) row.borderWidth = style[\"borderWidth\"] as number;\r\n                        if (style[\"borderColor\"]) row.borderColor = (style[\"borderColor\"] as any).solid.color;\r\n                    }\r\n                }\r\n                \r\n                // Appliquer les changements en attente (optimiste)\r\n                if (this.pendingChanges.has(originalName)) {\r\n                    const pending = this.pendingChanges.get(originalName);\r\n                    if (Date.now() - pending.timestamp < 30000) {\r\n                        let allMatched = true;\r\n                        Object.keys(pending).forEach(key => {\r\n                            if (key === \"timestamp\") return;\r\n                            let match = false;\r\n                            if (typeof pending[key] === 'number' && typeof row[key] === 'number') {\r\n                                match = Math.abs(pending[key] - row[key]) < 0.01;\r\n                            } else {\r\n                                match = pending[key] === row[key];\r\n                            }\r\n                            if (!match) {\r\n                                row[key] = pending[key];\r\n                                allMatched = false;\r\n                            }\r\n                        });\r\n                        if (allMatched) this.pendingChanges.delete(originalName);\r\n                    } else {\r\n                        this.pendingChanges.delete(originalName);\r\n                    }\r\n                }\r\n                \r\n                if (row.columnIndex > maxColumnIndexUsed) maxColumnIndexUsed = row.columnIndex;\r\n                this.allRowsData.push(row);\r\n            });\r\n        }\r\n\r\n        // 3. LIGNES MANUELLES DYNAMIQUES\r\n        if (this.metadata && this.metadata.objects) {\r\n            Object.keys(this.metadata.objects).forEach(key => {\r\n                if (key.startsWith(\"manualLine\")) {\r\n                    this.manualLineKeys.push(key);\r\n                    const s = this.metadata.objects[key];\r\n                    if (s[\"show\"] === true) {\r\n                        let txt = s[\"text\"] ? s[\"text\"] as string : \"Nouvelle Ligne\";\r\n                        let col = s[\"col\"] ? s[\"col\"] as number : 1;\r\n                        let pos = s[\"pos\"] ? s[\"pos\"] as number : 0;\r\n                        let isHead = s[\"isHeader\"] ? s[\"isHeader\"] as boolean : false;\r\n                        let bg = s[\"bgColor\"] ? (s[\"bgColor\"] as any).solid.color : \"transparent\";\r\n                        let color = s[\"textColor\"] ? (s[\"textColor\"] as any).solid.color : \"black\";\r\n                        let mt = s[\"marginTop\"] ? s[\"marginTop\"] as number : 0;\r\n                        let fs = s[\"fontSize\"] ? s[\"fontSize\"] as number : 12;\r\n                        let bo = s[\"bold\"] ? s[\"bold\"] as boolean : false;\r\n                        let it = s[\"italic\"] ? s[\"italic\"] as boolean : false;\r\n                        let bw = s[\"borderWidth\"] !== undefined ? s[\"borderWidth\"] as number : 1;\r\n                        let bc = s[\"borderColor\"] ? (s[\"borderColor\"] as any).solid.color : \"#eee\";\r\n\r\n                        let vRow: RowData = {\r\n                            originalName: key,\r\n                            label: txt, amount: \"\", \r\n                            columnIndex: col, sortIndex: pos,\r\n                            marginBottom: 0, marginTop: mt, isHidden: false, marginColor: \"transparent\",\r\n                            isHeader: isHead, isVirtual: true, customAmount: \"\",\r\n                            font: \"'Segoe UI', sans-serif\", fontSize: fs,\r\n                            bgLabel: bg, colorLabel: color, boldLabel: bo, italicLabel: it,\r\n                            bgAmount: bg, colorAmount: color, boldAmount: bo,\r\n                            borderWidth: bw,\r\n                            borderColor: bc\r\n                        };\r\n                        this.allRowsData.push(vRow);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // 4. RENDU\r\n        let maxColumnsToShow = Math.max(maxColumnIndexUsed, this.columnTitles.length);\r\n        \r\n        this.flexContainer.style.borderWidth = `${this.tableBorderWidth}px`;\r\n        this.flexContainer.style.borderStyle = this.tableBorderStyle;\r\n        this.flexContainer.style.borderColor = this.tableBorderColor;\r\n        this.flexContainer.style.borderRadius = `${this.tableBorderRadius}px`;\r\n        \r\n        for (let i = 1; i <= maxColumnsToShow; i++) {\r\n            const colDiv = document.createElement(\"div\");\r\n            colDiv.className = \"dynamic-column\"; \r\n            const table = document.createElement(\"table\");\r\n            colDiv.appendChild(table);\r\n\r\n            const colRows = this.allRowsData.filter(r => r.columnIndex === i);\r\n            const colTitle = this.columnTitles[i-1] || (\"COLONNE \" + i);\r\n            const categories = this.categoricalData ? this.categoricalData.categories[0] : null;\r\n            this.renderTableContent(table, colTitle, colRows, i, categories);\r\n            this.flexContainer.appendChild(colDiv);\r\n        }\r\n\r\n        // Bouton d'action uniquement si activ\r\n        if (showActionButton) {\r\n            const toggleBtn = document.createElement(\"button\");\r\n            toggleBtn.type = \"button\";\r\n            toggleBtn.className = \"toggle-actions-button\";\r\n            toggleBtn.textContent = this.areActionButtonsVisible ? \"\" : \"\";\r\n            toggleBtn.title = this.areActionButtonsVisible ? \"Masquer les boutons d'action\" : \"Afficher les boutons d'action\";\r\n            toggleBtn.style.display = \"flex\";\r\n            toggleBtn.style.alignItems = \"center\";\r\n            toggleBtn.style.justifyContent = \"center\";\r\n            toggleBtn.style.minWidth = \"32px\";\r\n            toggleBtn.style.height = \"32px\";\r\n            toggleBtn.style.cursor = \"pointer\";\r\n            toggleBtn.style.fontSize = \"16px\";\r\n            toggleBtn.style.color = \"#007acc\";\r\n            toggleBtn.style.border = \"1px solid #b3d7ff\";\r\n            toggleBtn.style.borderRadius = \"50%\";\r\n            toggleBtn.style.margin = \"6px\";\r\n            toggleBtn.style.background = \"white\";\r\n            toggleBtn.style.boxShadow = \"0 1px 4px rgba(0,0,0,0.08)\";\r\n            toggleBtn.style.transition = \"all 0.2s\";\r\n            toggleBtn.style.zIndex = \"1000\";\r\n            toggleBtn.onmouseover = () => { \r\n                toggleBtn.style.background = \"#e6f2ff\";\r\n                toggleBtn.style.borderColor = \"#007acc\";\r\n                toggleBtn.style.transform = \"scale(1.1)\";\r\n            };\r\n            toggleBtn.onmouseout = () => { \r\n                toggleBtn.style.background = \"white\";\r\n                toggleBtn.style.borderColor = \"#b3d7ff\";\r\n                toggleBtn.style.transform = \"scale(1)\";\r\n            };\r\n            toggleBtn.onclick = (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.areActionButtonsVisible = !this.areActionButtonsVisible;\r\n                toggleBtn.textContent = this.areActionButtonsVisible ? \"\" : \"\";\r\n                toggleBtn.title = this.areActionButtonsVisible ? \"Masquer les boutons d'action\" : \"Afficher les boutons d'action\";\r\n                addColumnDiv.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n                addLineBtn.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n                if (removeColumnDiv) {\r\n                    removeColumnDiv.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n                }\r\n            };\r\n            this.flexContainer.appendChild(toggleBtn);\r\n        }\r\n        \r\n        const addColumnDiv = document.createElement(\"button\");\r\n        addColumnDiv.type = \"button\";\r\n        addColumnDiv.className = \"add-column-button\";\r\n        addColumnDiv.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n        addColumnDiv.style.alignItems = \"center\";\r\n        addColumnDiv.style.justifyContent = \"center\";\r\n        addColumnDiv.style.minWidth = \"40px\";\r\n        addColumnDiv.style.cursor = \"pointer\";\r\n        addColumnDiv.style.opacity = \"0.5\";\r\n        addColumnDiv.style.transition = \"opacity 0.2s\";\r\n        addColumnDiv.style.fontSize = \"18px\";\r\n        addColumnDiv.style.color = \"#666\";\r\n        addColumnDiv.style.border = \"2px dashed #ccc\";\r\n        addColumnDiv.style.borderRadius = \"6px\";\r\n        addColumnDiv.style.margin = \"10px\";\r\n        addColumnDiv.style.padding = \"12px\";\r\n        addColumnDiv.style.background = \"transparent\";\r\n        addColumnDiv.style.zIndex = \"1000\";\r\n        addColumnDiv.textContent = \"\";\r\n        addColumnDiv.title = \"Ajouter une nouvelle colonne\";\r\n        \r\n        addColumnDiv.onmouseover = () => { \r\n            addColumnDiv.style.opacity = \"1\"; \r\n            addColumnDiv.style.borderColor = \"#999\";\r\n        };\r\n        addColumnDiv.onmouseout = () => { \r\n            addColumnDiv.style.opacity = \"0.5\"; \r\n            addColumnDiv.style.borderColor = \"#ccc\";\r\n        };\r\n        \r\n        const handleAddColumn = (e: Event) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            e.stopImmediatePropagation();\r\n            const newIndex = this.columnTitles.length + 1;\r\n            const newTitle = \"COLONNE \" + newIndex;\r\n            this.host.persistProperties({\r\n                merge: [{\r\n                    objectName: \"titresColonnes\",\r\n                    selector: null,\r\n                    properties: { [\"titre\" + newIndex]: newTitle }\r\n                }]\r\n            });\r\n        };\r\n        \r\n        addColumnDiv.addEventListener('click', handleAddColumn, true);\r\n        addColumnDiv.addEventListener('mousedown', (e) => { e.preventDefault(); e.stopPropagation(); }, true);\r\n        addColumnDiv.addEventListener('mouseup', (e) => { e.preventDefault(); e.stopPropagation(); }, true);\r\n        this.flexContainer.appendChild(addColumnDiv);\r\n\r\n        let removeColumnDiv: HTMLButtonElement | null = null;\r\n        if (maxColumnsToShow > 1) {\r\n            const emptyCols: number[] = [];\r\n            for (let i = 1; i <= maxColumnsToShow; i++) {\r\n                const colRows = this.allRowsData.filter(r => r.columnIndex === i && !r.isHidden);\r\n                if (colRows.length === 0) emptyCols.push(i);\r\n            }\r\n\r\n            if (emptyCols.length > 0) {\r\n                removeColumnDiv = document.createElement(\"button\");\r\n                removeColumnDiv.type = \"button\";\r\n                removeColumnDiv.className = \"remove-column-button\";\r\n                removeColumnDiv.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n                removeColumnDiv.style.alignItems = \"center\";\r\n                removeColumnDiv.style.justifyContent = \"center\";\r\n                removeColumnDiv.style.minWidth = \"40px\";\r\n                removeColumnDiv.style.cursor = \"pointer\";\r\n                removeColumnDiv.style.opacity = \"0.7\";\r\n                removeColumnDiv.style.transition = \"opacity 0.2s\";\r\n                removeColumnDiv.style.fontSize = \"18px\";\r\n                removeColumnDiv.style.color = \"#c00\";\r\n                removeColumnDiv.style.border = \"2px dashed #c00\";\r\n                removeColumnDiv.style.borderRadius = \"6px\";\r\n                removeColumnDiv.style.margin = \"10px\";\r\n                removeColumnDiv.style.padding = \"12px\";\r\n                removeColumnDiv.style.background = \"transparent\";\r\n                removeColumnDiv.style.zIndex = \"1000\";\r\n                removeColumnDiv.textContent = \"\";\r\n                removeColumnDiv.title = `Supprimer toutes les colonnes vides (${emptyCols.join(\", \")})`;\r\n\r\n                removeColumnDiv.onclick = (e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    e.stopImmediatePropagation();\r\n                    emptyCols.forEach(col => {\r\n                        this.host.persistProperties({\r\n                            replace: [{\r\n                                objectName: \"titresColonnes\",\r\n                                selector: null,\r\n                                properties: { [\"titre\" + col]: undefined }\r\n                            }]\r\n                        });\r\n                    });\r\n                };\r\n                this.flexContainer.appendChild(removeColumnDiv);\r\n            }\r\n        }\r\n\r\n        const addLineBtn = document.createElement(\"button\");\r\n        addLineBtn.type = \"button\";\r\n        addLineBtn.className = \"add-line-button\";\r\n        addLineBtn.style.display = this.areActionButtonsVisible ? \"flex\" : \"none\";\r\n        \r\n        const btnContainer = document.createElement(\"span\");\r\n        btnContainer.style.display = \"flex\";\r\n        btnContainer.style.alignItems = \"center\";\r\n        btnContainer.style.gap = \"6px\";\r\n\r\n        const btnIcon = document.createElement(\"span\");\r\n        btnIcon.style.display = \"flex\";\r\n        btnIcon.style.alignItems = \"center\";\r\n        btnIcon.style.justifyContent = \"center\";\r\n        btnIcon.style.width = \"22px\";\r\n        btnIcon.style.height = \"22px\";\r\n        btnIcon.style.background = \"#e6f2ff\";\r\n        btnIcon.style.borderRadius = \"50%\";\r\n        btnIcon.style.border = \"1px solid #b3d7ff\";\r\n        btnIcon.style.color = \"#007acc\";\r\n        btnIcon.style.fontSize = \"16px\";\r\n        btnIcon.style.fontWeight = \"bold\";\r\n        btnIcon.style.boxSizing = \"border-box\";\r\n        btnIcon.textContent = \"+\";\r\n\r\n        const btnText = document.createElement(\"span\");\r\n        btnText.style.color = \"#007acc\";\r\n        btnText.style.fontSize = \"14px\";\r\n        btnText.style.fontWeight = \"500\";\r\n        btnText.textContent = \"Ligne\";\r\n\r\n        btnContainer.appendChild(btnIcon);\r\n        btnContainer.appendChild(btnText);\r\n        addLineBtn.appendChild(btnContainer);\r\n\r\n        addLineBtn.title = \"Ajouter une nouvelle ligne\";\r\n        addLineBtn.style.margin = \"6px\";\r\n        addLineBtn.style.padding = \"2px 12px\";\r\n        addLineBtn.style.background = \"white\";\r\n        addLineBtn.style.border = \"1px solid #b3d7ff\";\r\n        addLineBtn.style.borderRadius = \"18px\";\r\n        addLineBtn.style.boxShadow = \"0 1px 4px rgba(0,0,0,0.04)\";\r\n        addLineBtn.style.cursor = \"pointer\";\r\n        addLineBtn.style.alignItems = \"center\";\r\n        addLineBtn.style.justifyContent = \"center\";\r\n        addLineBtn.style.fontFamily = \"'Segoe UI', Arial, sans-serif\";\r\n        addLineBtn.style.fontSize = \"14px\";\r\n        addLineBtn.onmouseover = () => {\r\n            addLineBtn.style.background = \"#e6f2ff\";\r\n            addLineBtn.style.borderColor = \"#007acc\";\r\n        };\r\n        addLineBtn.onmouseout = () => {\r\n            addLineBtn.style.background = \"white\";\r\n            addLineBtn.style.borderColor = \"#b3d7ff\";\r\n        };\r\n        addLineBtn.onclick = (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            let nextIndex = 1;\r\n            while (this.manualLineKeys.includes(\"manualLine\" + nextIndex)) {\r\n                nextIndex++;\r\n            }\r\n            const newKey = \"manualLine\" + nextIndex;\r\n            this.host.persistProperties({\r\n                merge: [{\r\n                    objectName: newKey,\r\n                    selector: null,\r\n                    properties: {\r\n                        text: \"Nouvelle Ligne \" + nextIndex,\r\n                        show: true,\r\n                        col: 1,\r\n                        pos: 0,\r\n                        isHeader: false,\r\n                        bgColor: { solid: { color: \"transparent\" } },\r\n                        textColor: { solid: { color: \"black\" } },\r\n                        marginTop: 0,\r\n                        fontSize: 12,\r\n                        bold: false,\r\n                        italic: false\r\n                    }\r\n                }]\r\n            });\r\n        };\r\n        this.flexContainer.appendChild(addLineBtn);\r\n    }\r\n\r\n    /**\r\n     * NOUVELLE MTHODE OBLIGATOIRE API 5.1+\r\n     * Remplace enumerateObjectInstances pour la certification Power BI\r\n     */\r\n    public getFormattingModel(): powerbi.visuals.FormattingModel {\r\n        const model = this.formattingSettings; \r\n        \r\n        // ---------------------------------------------------------\r\n        // A. TITRES COLONNES\r\n        // ---------------------------------------------------------\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"titresColonnes\"]) {\r\n            const tObj = this.metadata.objects[\"titresColonnes\"];\r\n            model.titresColonnes.slices.forEach(slice => {\r\n                if (tObj[slice.name]) {\r\n                    (slice as formattingSettings.TextInput).value = tObj[slice.name];\r\n                }\r\n            });\r\n        }\r\n\r\n        // ---------------------------------------------------------\r\n        // B. MENU SLECTION\r\n        // ---------------------------------------------------------\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"selectionMenu\"]) {\r\n            model.selectionMenu.ligneActive.value = this.metadata.objects[\"selectionMenu\"][\"ligneActive\"];\r\n        }\r\n\r\n        // ---------------------------------------------------------\r\n        // C. STYLE DE LIGNE (Logique contextuelle)\r\n        // ---------------------------------------------------------\r\n        if (this.categoricalData) {\r\n            const categories = this.categoricalData.categories[0];\r\n            const indexChoisi = categories.values.findIndex(v => v.toString() === this.currentSelectedLabel);\r\n\r\n            if (indexChoisi !== -1) {\r\n                const styleCard = model.styleLigne;\r\n                \r\n                const selectionId = this.host.createSelectionIdBuilder()\r\n                    .withCategory(categories, indexChoisi)\r\n                    .createSelectionId();\r\n                \r\n                // Assigner le slecteur\r\n                const selector = selectionId.getSelector();\r\n                styleCard.selector = selector;\r\n                // CORRECTION: assigner aussi le selector  CHAQUE slice pour que les persistProperties\r\n                // dclenchs depuis le panneau de format ciblent bien la ligne slectionne.\r\n                (styleCard.slices || []).forEach(s => { (s as any).selector = selector; });\r\n\r\n                const currentRow = this.allRowsData.find(r => r.originalName === this.currentSelectedLabel);\r\n                \r\n                if (currentRow) {\r\n                    // Remplissage dynamique des slices par leur name  vite les problmes de typage (color pickers, etc.)\r\n                    (styleCard.slices || []).forEach(slice => {\r\n                        const name = (slice as any).name;\r\n                        if (!name) return;\r\n                        switch (name) {\r\n                            case \"columnIndex\": (slice as any).value = currentRow.columnIndex; break;\r\n                            case \"ordreTri\": (slice as any).value = currentRow.sortIndex; break;\r\n                            case \"marginTop\": (slice as any).value = currentRow.marginTop; break;\r\n                            case \"marginBottom\": (slice as any).value = currentRow.marginBottom; break;\r\n                            case \"marginColor\": (slice as any).value = { value: currentRow.marginColor }; break;\r\n                            case \"isHidden\": (slice as any).value = currentRow.isHidden; break;\r\n                            case \"isHeader\": (slice as any).value = currentRow.isHeader; break;\r\n                            case \"customLabel\": (slice as any).value = currentRow.customLabel || \"\"; break;\r\n                            case \"customAmount\": (slice as any).value = currentRow.customAmount || \"\"; break;\r\n                            case \"fontSize\": (slice as any).value = currentRow.fontSize; break;\r\n                            case \"fontFamily\": (slice as any).value = currentRow.font; break;\r\n                            case \"bgLabel\": (slice as any).value = { value: currentRow.bgLabel }; break;\r\n                            case \"fillLabel\": (slice as any).value = { value: currentRow.colorLabel }; break;\r\n                            case \"boldLabel\": (slice as any).value = currentRow.boldLabel; break;\r\n                            case \"italicLabel\": (slice as any).value = currentRow.italicLabel; break;\r\n                            case \"bgAmount\": (slice as any).value = { value: currentRow.bgAmount }; break;\r\n                            case \"fillAmount\": (slice as any).value = { value: currentRow.colorAmount }; break;\r\n                            case \"boldAmount\": (slice as any).value = currentRow.boldAmount; break;\r\n                            case \"borderWidth\": (slice as any).value = currentRow.borderWidth; break;\r\n                            case \"borderColor\": (slice as any).value = { value: currentRow.borderColor }; break;\r\n                            default: break;\r\n                        }\r\n                    });\r\n                 }\r\n            }\r\n        }\r\n\r\n        // ---------------------------------------------------------\r\n        // D. LIGNES MANUELLES (Dynamique)\r\n        // ---------------------------------------------------------\r\n        if (this.metadata && this.metadata.objects) {\r\n            const keys = Object.keys(this.metadata.objects).filter(k => k.startsWith(\"manualLine\")).sort();\r\n            \r\n            keys.forEach(key => {\r\n                const manualObj = this.metadata.objects[key];\r\n                \r\n                const manualCard = new ManualLineSettings();\r\n                manualCard.name = key;\r\n                manualCard.displayName = manualObj[\"text\"] ? String(manualObj[\"text\"]) : key;\r\n                \r\n                manualCard.text.value = manualObj[\"text\"];\r\n                manualCard.show.value = manualObj[\"show\"];\r\n                manualCard.col.value = manualObj[\"col\"];\r\n                manualCard.pos.value = manualObj[\"pos\"];\r\n                manualCard.isHeader.value = manualObj[\"isHeader\"];\r\n                if (manualObj[\"bgColor\"]) manualCard.bgColor.value = manualObj[\"bgColor\"][\"solid\"][\"color\"];\r\n                if (manualObj[\"textColor\"]) manualCard.textColor.value = manualObj[\"textColor\"][\"solid\"][\"color\"];\r\n                manualCard.marginTop.value = manualObj[\"marginTop\"];\r\n                manualCard.fontSize.value = manualObj[\"fontSize\"];\r\n                manualCard.bold.value = manualObj[\"bold\"];\r\n                manualCard.italic.value = manualObj[\"italic\"];\r\n                manualCard.borderWidth.value = manualObj[\"borderWidth\"];\r\n                if (manualObj[\"borderColor\"]) manualCard.borderColor.value = manualObj[\"borderColor\"][\"solid\"][\"color\"];\r\n\r\n                // Ajouter la carte manuelle  la liste des cartes du modle\r\n                model.cards.push(manualCard);\r\n            });\r\n        }\r\n\r\n        // ---------------------------------------------------------\r\n        // E. BORDURES GLOBALES\r\n        // ---------------------------------------------------------\r\n        if (this.metadata && this.metadata.objects && this.metadata.objects[\"tableBorders\"]) {\r\n            const borderObj = this.metadata.objects[\"tableBorders\"];\r\n            model.tableBorders.borderWidth.value = borderObj[\"borderWidth\"];\r\n            model.tableBorders.borderRadius.value = borderObj[\"borderRadius\"];\r\n            if (borderObj[\"borderColor\"]) model.tableBorders.borderColor.value = borderObj[\"borderColor\"][\"solid\"][\"color\"];\r\n            if (borderObj[\"borderStyle\"]) model.tableBorders.borderStyle.value = { value: borderObj[\"borderStyle\"] as string, displayName: borderObj[\"borderStyle\"] as string };\r\n        }\r\n\r\n        // CORRECTION MAJEURE: Utiliser le service pour construire le modle\r\n        return this.formattingSettingsService.buildFormattingModel(model);\r\n    }\r\n\r\n    private renderTableContent(targetTable: HTMLTableElement, title: string, rows: RowData[], colIndex: number, categories: any) {\r\n        // [Contenu inchang pour le rendu]\r\n        rows.sort((a, b) => a.sortIndex - b.sortIndex);\r\n        \r\n        const thead = document.createElement(\"thead\");\r\n        const trHead = document.createElement(\"tr\");\r\n        const th = document.createElement(\"th\");\r\n        th.colSpan = 2;\r\n        th.style.position = \"relative\";\r\n        th.style.paddingRight = \"30px\";\r\n        \r\n        const titleSpan = document.createElement(\"span\");\r\n        titleSpan.innerText = title;\r\n        titleSpan.contentEditable = \"false\";\r\n        titleSpan.style.outline = \"none\";\r\n        titleSpan.style.display = \"inline-block\";\r\n        titleSpan.style.minWidth = \"100px\";\r\n        th.appendChild(titleSpan);\r\n        \r\n        const editBtn = document.createElement(\"button\");\r\n        editBtn.innerText = \"\";\r\n        editBtn.style.position = \"absolute\";\r\n        editBtn.style.right = \"5px\";\r\n        editBtn.style.top = \"50%\";\r\n        editBtn.style.transform = \"translateY(-50%)\";\r\n        editBtn.style.cursor = \"pointer\";\r\n        editBtn.style.fontSize = \"14px\";\r\n        editBtn.style.opacity = \"0.6\";\r\n        editBtn.style.transition = \"opacity 0.2s\";\r\n        editBtn.style.border = \"none\";\r\n        editBtn.style.background = \"transparent\";\r\n        editBtn.style.padding = \"2px 6px\";\r\n        editBtn.style.zIndex = \"1000\";\r\n        editBtn.title = \"Renommer cette colonne\";\r\n        editBtn.type = \"button\";\r\n        \r\n        editBtn.onmouseover = () => { editBtn.style.opacity = \"1\"; };\r\n        editBtn.onmouseout = () => { editBtn.style.opacity = \"0.6\"; };\r\n        \r\n        const handleEdit = (e: Event) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            e.stopImmediatePropagation();\r\n            titleSpan.contentEditable = \"true\";\r\n            titleSpan.style.backgroundColor = \"#fff3cd\";\r\n            titleSpan.style.color = \"#000000\";\r\n            titleSpan.style.padding = \"2px 4px\";\r\n            titleSpan.style.borderRadius = \"3px\";\r\n            titleSpan.focus();\r\n            const range = document.createRange();\r\n            range.selectNodeContents(titleSpan);\r\n            const selection = window.getSelection();\r\n            selection?.removeAllRanges();\r\n            selection?.addRange(range);\r\n            editBtn.innerText = \"\";\r\n            editBtn.style.color = \"green\";\r\n        };\r\n        \r\n        const saveEdit = () => {\r\n            const newTitle = titleSpan.innerText.trim();\r\n            if (newTitle && newTitle !== title) {\r\n                this.host.persistProperties({\r\n                    merge: [{\r\n                        objectName: \"titresColonnes\",\r\n                        selector: null,\r\n                        properties: { [\"titre\" + colIndex]: newTitle }\r\n                    }]\r\n                });\r\n            }\r\n            titleSpan.contentEditable = \"false\";\r\n            titleSpan.style.backgroundColor = \"transparent\";\r\n            titleSpan.style.color = \"\";\r\n            titleSpan.style.padding = \"0\";\r\n            editBtn.innerText = \"\";\r\n            editBtn.style.color = \"\";\r\n        };\r\n        \r\n        titleSpan.addEventListener('keydown', (e: KeyboardEvent) => {\r\n            if (e.key === 'Enter') {\r\n                e.preventDefault();\r\n                saveEdit();\r\n            }\r\n            if (e.key === 'Escape') {\r\n                titleSpan.innerText = title;\r\n                titleSpan.contentEditable = \"false\";\r\n                titleSpan.style.backgroundColor = \"transparent\";\r\n                titleSpan.style.color = \"\";\r\n                titleSpan.style.padding = \"0\";\r\n                editBtn.innerText = \"\";\r\n                editBtn.style.color = \"\";\r\n            }\r\n        });\r\n        \r\n        titleSpan.addEventListener('blur', () => {\r\n            if (titleSpan.contentEditable === \"true\") saveEdit();\r\n        });\r\n        \r\n        editBtn.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            e.stopImmediatePropagation();\r\n            if (titleSpan.contentEditable === \"true\") saveEdit(); else handleEdit(e);\r\n        }, true);\r\n        \r\n        editBtn.addEventListener('mousedown', (e) => { e.stopPropagation(); }, true);\r\n        editBtn.addEventListener('mouseup', (e) => { e.stopPropagation(); }, true);\r\n        \r\n        th.appendChild(editBtn);\r\n        trHead.appendChild(th); thead.appendChild(trHead); targetTable.appendChild(thead);\r\n\r\n        const tbody = document.createElement(\"tbody\");\r\n        rows.forEach(row => {\r\n            if (row.isHidden) return; \r\n\r\n            if (row.marginTop > 0) {\r\n                const trSp = document.createElement(\"tr\");\r\n                trSp.style.height = row.marginTop + \"px\";\r\n                trSp.style.lineHeight = \"0\";\r\n                trSp.style.fontSize = \"0\";\r\n                const tdSp = document.createElement(\"td\");\r\n                tdSp.colSpan = 2; \r\n                tdSp.style.backgroundColor = row.marginColor; \r\n                tdSp.style.border = \"none\";\r\n                tdSp.style.padding = \"0\";\r\n                tdSp.style.margin = \"0\";\r\n                tdSp.style.height = row.marginTop + \"px\";\r\n                trSp.appendChild(tdSp); \r\n                tbody.appendChild(trSp);\r\n            }\r\n\r\n            const tr = document.createElement(\"tr\");\r\n            tr.draggable = true;\r\n            tr.style.cursor = \"move\";\r\n            \r\n            tr.ondragstart = (e: DragEvent) => {\r\n                e.stopPropagation();\r\n                if (e.dataTransfer) {\r\n                    e.dataTransfer.effectAllowed = \"move\";\r\n                    const dragData = {\r\n                        label: row.label,\r\n                        originalName: row.originalName,\r\n                        columnIndex: row.columnIndex,\r\n                        sortIndex: row.sortIndex,\r\n                        isVirtual: row.isVirtual\r\n                    };\r\n                    e.dataTransfer.setData(\"text/plain\", JSON.stringify(dragData));\r\n                    tr.style.opacity = \"0.5\";\r\n                    // DEBUG\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(\"DRAG START:\", dragData);\r\n                }\r\n            };\r\n            \r\n            tr.ondragend = (e: DragEvent) => { tr.style.opacity = \"1\"; };\r\n            // DEBUG: highlight when row receives drop events\r\n            tr.ondragover = (e: DragEvent) => {\r\n                e.preventDefault();\r\n                if (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\r\n                tr.style.borderTop = \"2px solid #007acc\";\r\n            };\r\n            tr.ondragleave = (e: DragEvent) => { tr.style.borderTop = \"\"; };\r\n            tr.ondrop = (e: DragEvent) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                tr.style.borderTop = \"\";\r\n                // DEBUG\r\n                // eslint-disable-next-line no-console\r\n                console.log(\"DROP ON ROW\", { target: row.originalName });\r\n                if (e.dataTransfer) {\r\n                    const dataStr = e.dataTransfer.getData(\"text/plain\");\r\n                    const data = JSON.parse(dataStr);\r\n                    const draggedOriginalName = data.originalName;\r\n                    const isVirtual = data.isVirtual;\r\n\r\n                    if (draggedOriginalName !== row.originalName) {\r\n                        const targetRowIndex = rows.findIndex(r => r.originalName === row.originalName);\r\n                        let prevSortIndex = -1000;\r\n                        if (targetRowIndex > 0) {\r\n                            prevSortIndex = rows[targetRowIndex - 1].sortIndex;\r\n                        } else {\r\n                            prevSortIndex = row.sortIndex - 20;\r\n                        }\r\n                        let newSortIndex = (prevSortIndex + row.sortIndex) / 2;\r\n\r\n                        if (isVirtual) {\r\n                            const currentDraggedRow = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                            if (currentDraggedRow) {\r\n                                currentDraggedRow.columnIndex = colIndex;\r\n                                currentDraggedRow.sortIndex = newSortIndex;\r\n                                this.pendingChanges.set(draggedOriginalName, {\r\n                                    columnIndex: colIndex,\r\n                                    sortIndex: newSortIndex,\r\n                                    timestamp: Date.now()\r\n                                });\r\n                                // nouveau : persistance centralise\r\n                                this.persistStyle(null, { col: colIndex, pos: newSortIndex }, draggedOriginalName);\r\n                                // DEBUG\r\n                                // eslint-disable-next-line no-console\r\n                                console.log(\"PERSIST (virtual) ->\", { object: draggedOriginalName, props: { col: colIndex, pos: newSortIndex } });\r\n                                while (this.flexContainer.firstChild) {\r\n                                    this.flexContainer.removeChild(this.flexContainer.firstChild);\r\n                                }\r\n                                let maxColUsed = 1;\r\n                                this.allRowsData.forEach(r => { if (r.columnIndex > maxColUsed) maxColUsed = r.columnIndex; });\r\n                                let maxColumnsToShow = Math.max(maxColUsed, this.columnTitles.length);\r\n                                for (let i = 1; i <= maxColumnsToShow; i++) {\r\n                                    const colDiv = document.createElement(\"div\");\r\n                                    colDiv.className = \"dynamic-column\"; \r\n                                    const table = document.createElement(\"table\");\r\n                                    colDiv.appendChild(table);\r\n                                    const colRows = this.allRowsData.filter(r => r.columnIndex === i);\r\n                                    const colTitle = this.columnTitles[i-1] || (\"COLONNE \" + i);\r\n                                    this.renderTableContent(table, colTitle, colRows, i, categories);\r\n                                    this.flexContainer.appendChild(colDiv);\r\n                                }\r\n                            }\r\n                        } else if (categories) {\r\n                            const draggedIndex = categories.values.findIndex(v => v.toString() === draggedOriginalName);\r\n                            if (draggedIndex !== -1) {\r\n                                const selectionId = this.host.createSelectionIdBuilder().withCategory(categories, draggedIndex).createSelectionId();\r\n                                const currentDraggedRow = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                                let existingProps: any = {\r\n                                    // marginBottom: 0, marginTop: 0, isHidden: false, marginColor: {solid:{color:\"transparent\"}},\r\n                                    // customLabel: \"\", customAmount: \"\", isHeader: false, fontSize: 12, fontFamily: \"'Segoe UI', sans-serif\", \r\n                                    // bgLabel: {solid:{color:\"transparent\"}}, fillLabel: {solid:{color:\"black\"}}, italicLabel: false, boldLabel: false,\r\n                                    // bgAmount: {solid:{color:\"transparent\"}}, fillAmount: {solid:{color:\"black\"}}, boldAmount: false\r\n                                };\r\n                                if (currentDraggedRow) {\r\n                                    existingProps.marginBottom = currentDraggedRow.marginBottom;\r\n                                    existingProps.marginTop = currentDraggedRow.marginTop;\r\n                                    existingProps.isHidden = currentDraggedRow.isHidden;\r\n                                    existingProps.marginColor = { solid: { color: currentDraggedRow.marginColor } };\r\n                                    existingProps.customLabel = currentDraggedRow.customLabel || \"\";\r\n                                    existingProps.customAmount = currentDraggedRow.customAmount || \"\";\r\n                                    existingProps.isHeader = currentDraggedRow.isHeader;\r\n                                    existingProps.fontSize = currentDraggedRow.fontSize;\r\n                                    existingProps.fontFamily = currentDraggedRow.font;\r\n                                    existingProps.bgLabel = { solid: { color: currentDraggedRow.bgLabel } };\r\n                                    existingProps.fillLabel = { solid: { color: currentDraggedRow.colorLabel } };\r\n                                    existingProps.italicLabel = currentDraggedRow.italicLabel;\r\n                                    existingProps.boldLabel = currentDraggedRow.boldLabel;\r\n                                    existingProps.bgAmount = { solid: { color: currentDraggedRow.bgAmount } };\r\n                                    existingProps.fillAmount = { solid: { color: currentDraggedRow.colorAmount } };\r\n                                    existingProps.boldAmount = currentDraggedRow.boldAmount;\r\n                                } else if (categories.objects && categories.objects[draggedIndex]) {\r\n                                    const style = categories.objects[draggedIndex][\"styleLigne\"];\r\n                                    if (style) {\r\n                                        Object.keys(style).forEach(key => { if (key !== \"columnIndex\" && key !== \"ordreTri\") existingProps[key] = style[key]; });\r\n                                    }\r\n                                }\r\n                                existingProps.columnIndex = colIndex;\r\n                                existingProps.ordreTri = newSortIndex;\r\n                                // CLEAN undefined keys\r\n                                Object.keys(existingProps).forEach(k => { if (existingProps[k] === undefined) delete existingProps[k]; });\r\n                                // DEBUG before persist\r\n                                // eslint-disable-next-line no-console\r\n                                console.log(\"PERSIST (category) -> selector:\", selectionId.getSelector(), \"props:\", existingProps);\r\n                                // nouveau : persistance centralise\r\n                                this.persistStyle(selectionId.getSelector(), existingProps, \"styleLigne\");\r\n                                // DEBUG after persist\r\n                                // eslint-disable-next-line no-console\r\n                                console.log(\"PERSIST DONE (category) for\", draggedOriginalName);\r\n                                const draggedRowData = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                                if (draggedRowData) {\r\n                                    draggedRowData.columnIndex = colIndex;\r\n                                    draggedRowData.sortIndex = newSortIndex;\r\n                                    this.pendingChanges.set(draggedOriginalName, {\r\n                                        columnIndex: colIndex, sortIndex: newSortIndex,\r\n                                        marginBottom: draggedRowData.marginBottom, marginTop: draggedRowData.marginTop, isHidden: draggedRowData.isHidden,\r\n                                        marginColor: draggedRowData.marginColor, customLabel: draggedRowData.customLabel, customAmount: draggedRowData.customAmount,\r\n                                        isHeader: draggedRowData.isHeader, fontSize: draggedRowData.fontSize, font: draggedRowData.font,\r\n                                        bgLabel: draggedRowData.bgLabel, colorLabel: draggedRowData.colorLabel, italicLabel: draggedRowData.italicLabel,\r\n                                        boldLabel: draggedRowData.boldLabel, bgAmount: draggedRowData.bgAmount, colorAmount: draggedRowData.colorAmount,\r\n                                        boldAmount: draggedRowData.boldAmount, timestamp: Date.now()\r\n                                    });\r\n                                    while (this.flexContainer.firstChild) { this.flexContainer.removeChild(this.flexContainer.firstChild); }\r\n                                    let maxColUsed = 1;\r\n                                    this.allRowsData.forEach(r => { if (r.columnIndex > maxColUsed) maxColUsed = r.columnIndex; });\r\n                                    let maxColumnsToShow = Math.max(maxColUsed, this.columnTitles.length);\r\n                                    for (let i = 1; i <= maxColumnsToShow; i++) {\r\n                                        const colDiv = document.createElement(\"div\");\r\n                                        colDiv.className = \"dynamic-column\"; \r\n                                        const table = document.createElement(\"table\");\r\n                                        colDiv.appendChild(table);\r\n                                        const colRows = this.allRowsData.filter(r => r.columnIndex === i);\r\n                                        const colTitle = this.columnTitles[i-1] || (\"COLONNE \" + i);\r\n                                        this.renderTableContent(table, colTitle, colRows, i, categories);\r\n                                        this.flexContainer.appendChild(colDiv);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (!row.isVirtual) {\r\n                tr.onclick = (e: MouseEvent) => {\r\n                    if (tr.draggable && e.detail === 1) {\r\n                        e.stopPropagation(); \r\n                        this.host.persistProperties({\r\n                            merge: [{\r\n                                objectName: \"selectionMenu\",\r\n                                selector: null,\r\n                                properties: { \"ligneActive\": row.originalName }\r\n                            }]\r\n                        });\r\n                        this.showToolbar(row, tr, e.clientX, e.clientY, categories);\r\n                    }\r\n                };\r\n                \r\n                // MENU CONTEXTUEL POWER BI (clic droit)\r\n                tr.oncontextmenu = (e: MouseEvent) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    \r\n                    // Rcuprer l'index de la catgorie pour crer le selectionId\r\n                    const rowIndex = categories.values.findIndex((v: any) => v.toString() === row.originalName);\r\n                    if (rowIndex !== -1) {\r\n                        const selectionId = this.host.createSelectionIdBuilder()\r\n                            .withCategory(categories, rowIndex)\r\n                            .createSelectionId();\r\n                        \r\n                        // Afficher le menu contextuel Power BI natif\r\n                        this.selectionManager.showContextMenu(selectionId, {\r\n                            x: e.clientX,\r\n                            y: e.clientY\r\n                        });\r\n                    }\r\n                };\r\n                \r\n                tr.title = \"Cliquer pour modifier | Glisser pour dplacer | Clic droit pour options\";\r\n            } else {\r\n                // Menu contextuel pour les lignes manuelles (sans selectionId)\r\n                tr.oncontextmenu = (e: MouseEvent) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    \r\n                    // Pour les lignes virtuelles, menu contextuel simple\r\n                    this.selectionManager.showContextMenu(null, {\r\n                        x: e.clientX,\r\n                        y: e.clientY\r\n                    });\r\n                };\r\n                tr.title = \"Glisser pour dplacer | Clic droit pour options\";\r\n            }\r\n\r\n            let finalAmount = \"\";\r\n            if (row.customAmount && row.customAmount.trim() !== \"\") {\r\n                finalAmount = row.customAmount;\r\n            } else {\r\n                let rawVal = parseFloat(row.amount);\r\n                if (!row.isVirtual && !row.isHeader && row.amount && !isNaN(rawVal) && rawVal !== 0) {\r\n                    finalAmount = new Intl.NumberFormat('fr-FR', { style: 'decimal', minimumFractionDigits: 0 }).format(rawVal);\r\n                }\r\n            }\r\n\r\n            tr.style.fontFamily = row.font; tr.style.fontSize = row.fontSize + \"px\"; \r\n            const tdName = document.createElement(\"td\");\r\n            tdName.innerText = row.label;\r\n            const cellBg = (row.isHeader || row.isVirtual) ? row.bgLabel : row.bgLabel;\r\n            tdName.style.backgroundColor = cellBg; tdName.style.color = row.colorLabel;\r\n            if (row.boldLabel) tdName.style.fontWeight = \"bold\";\r\n            if (row.italicLabel) tdName.style.fontStyle = \"italic\";\r\n            const borderStyle = `${row.borderWidth}px solid ${row.borderColor}`;\r\n            tdName.style.border = borderStyle;\r\n            tdName.style.borderRight = \"none\"; \r\n            tr.appendChild(tdName);\r\n\r\n            const tdAmount = document.createElement(\"td\");\r\n            tdAmount.innerText = finalAmount; \r\n            tdAmount.style.textAlign = \"right\";\r\n            tdAmount.style.backgroundColor = (row.isHeader || row.isVirtual) ? row.bgLabel : row.bgAmount;\r\n            tdAmount.style.color = row.colorAmount;\r\n            if (row.boldAmount) tdAmount.style.fontWeight = \"bold\";\r\n            tdAmount.style.border = borderStyle;\r\n            tdAmount.style.borderLeft = \"none\"; \r\n            tr.appendChild(tdAmount);\r\n\r\n            tbody.appendChild(tr);\r\n\r\n            if (row.marginBottom > 0) {\r\n                const trSpB = document.createElement(\"tr\");\r\n                trSpB.style.height = row.marginBottom + \"px\";\r\n                trSpB.style.lineHeight = \"0\";\r\n                trSpB.style.fontSize = \"0\";\r\n                const tdSpB = document.createElement(\"td\");\r\n                tdSpB.colSpan = 2; \r\n                tdSpB.style.backgroundColor = row.marginColor; \r\n                tdSpB.style.border = \"none\";\r\n                tdSpB.style.padding = \"0\";\r\n                tdSpB.style.margin = \"0\";\r\n                tdSpB.style.height = row.marginBottom + \"px\";\r\n                trSpB.appendChild(tdSpB); \r\n                tbody.appendChild(trSpB);\r\n            }\r\n        });\r\n\r\n        const dropZoneTr = document.createElement(\"tr\");\r\n        dropZoneTr.style.height = \"40px\"; \r\n        const dropZoneTd = document.createElement(\"td\");\r\n        dropZoneTd.colSpan = 2;\r\n        dropZoneTd.style.backgroundColor = \"transparent\";\r\n        dropZoneTd.style.border = \"2px dashed transparent\";\r\n        dropZoneTd.style.transition = \"all 0.2s\";\r\n        dropZoneTd.textContent = \"\";\r\n        dropZoneTr.appendChild(dropZoneTd);\r\n\r\n        dropZoneTr.ondragover = (e) => {\r\n            e.preventDefault();\r\n            if (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\r\n            dropZoneTd.style.border = \"2px dashed #007acc\";\r\n            dropZoneTd.style.backgroundColor = \"rgba(0, 122, 204, 0.1)\";\r\n        };\r\n        dropZoneTr.ondragleave = (e) => {\r\n            dropZoneTd.style.border = \"2px dashed transparent\";\r\n            dropZoneTd.style.backgroundColor = \"transparent\";\r\n        };\r\n        dropZoneTr.ondrop = (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            dropZoneTd.style.border = \"2px dashed transparent\";\r\n            dropZoneTd.style.backgroundColor = \"transparent\";\r\n            if (e.dataTransfer) {\r\n                const dataStr = e.dataTransfer.getData(\"text/plain\");\r\n                const data = JSON.parse(dataStr);\r\n                const draggedOriginalName = data.originalName;\r\n                const isVirtual = data.isVirtual;\r\n                let lastSortIndex = 0;\r\n                if (rows.length > 0) lastSortIndex = rows[rows.length - 1].sortIndex;\r\n                let newSortIndex = lastSortIndex + 10;\r\n                if (isVirtual) {\r\n                    const currentDraggedRow = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                    if (currentDraggedRow) {\r\n                        currentDraggedRow.columnIndex = colIndex;\r\n                        currentDraggedRow.sortIndex = newSortIndex;\r\n                        this.pendingChanges.set(draggedOriginalName, {\r\n                            columnIndex: colIndex,\r\n                            sortIndex: newSortIndex,\r\n                            timestamp: Date.now()\r\n                        });\r\n                        // nouveau : persistance centralise\r\n                        this.persistStyle(null, { col: colIndex, pos: newSortIndex }, draggedOriginalName);\r\n                        // DEBUG\r\n                        // eslint-disable-next-line no-console\r\n                        console.log(\"PERSIST (virtual) ->\", { object: draggedOriginalName, props: { col: colIndex, pos: newSortIndex } });\r\n                        while (this.flexContainer.firstChild) {\r\n                            this.flexContainer.removeChild(this.flexContainer.firstChild);\r\n                        }\r\n                        let maxColUsed = 1;\r\n                        this.allRowsData.forEach(r => { if (r.columnIndex > maxColUsed) maxColUsed = r.columnIndex; });\r\n                        let maxColumnsToShow = Math.max(maxColUsed, this.columnTitles.length);\r\n                        for (let i = 1; i <= maxColumnsToShow; i++) {\r\n                            const colDiv = document.createElement(\"div\");\r\n                            colDiv.className = \"dynamic-column\"; \r\n                            const table = document.createElement(\"table\");\r\n                            colDiv.appendChild(table);\r\n                            const colRows = this.allRowsData.filter(r => r.columnIndex === i);\r\n                            const colTitle = this.columnTitles[i-1] || (\"COLONNE \" + i);\r\n                            this.renderTableContent(table, colTitle, colRows, i, categories);\r\n                            this.flexContainer.appendChild(colDiv);\r\n                        }\r\n                    }\r\n                } else if (categories) {\r\n                    const draggedIndex = categories.values.findIndex(v => v.toString() === draggedOriginalName);\r\n                    if (draggedIndex !== -1) {\r\n                        const selectionId = this.host.createSelectionIdBuilder().withCategory(categories, draggedIndex).createSelectionId();\r\n                        const currentDraggedRow = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                        let existingProps: any = {\r\n                            marginBottom: 0, marginTop: 0, isHidden: false, marginColor: {solid:{color:\"transparent\"}},\r\n                            customLabel: \"\", customAmount: \"\", isHeader: false, fontSize: 12, fontFamily: \"'Segoe UI', sans-serif\", \r\n                            bgLabel: {solid:{color:\"transparent\"}}, fillLabel: {solid:{color:\"black\"}}, italicLabel: false, boldLabel: false,\r\n                            bgAmount: {solid:{color:\"transparent\"}}, fillAmount: {solid:{color:\"black\"}}, boldAmount: false\r\n                        };\r\n                        if (currentDraggedRow) {\r\n                            existingProps.marginBottom = currentDraggedRow.marginBottom;\r\n                            existingProps.marginTop = currentDraggedRow.marginTop;\r\n                            existingProps.isHidden = currentDraggedRow.isHidden;\r\n                            existingProps.marginColor = { solid: { color: currentDraggedRow.marginColor } };\r\n                            existingProps.customLabel = currentDraggedRow.customLabel || \"\";\r\n                            existingProps.customAmount = currentDraggedRow.customAmount || \"\";\r\n                            existingProps.isHeader = currentDraggedRow.isHeader;\r\n                            existingProps.fontSize = currentDraggedRow.fontSize;\r\n                            existingProps.fontFamily = currentDraggedRow.font;\r\n                            existingProps.bgLabel = { solid: { color: currentDraggedRow.bgLabel } };\r\n                            existingProps.fillLabel = { solid: { color: currentDraggedRow.colorLabel } };\r\n                            existingProps.italicLabel = currentDraggedRow.italicLabel;\r\n                            existingProps.boldLabel = currentDraggedRow.boldLabel;\r\n                            existingProps.bgAmount = { solid: { color: currentDraggedRow.bgAmount } };\r\n                            existingProps.fillAmount = { solid: { color: currentDraggedRow.colorAmount } };\r\n                            existingProps.boldAmount = currentDraggedRow.boldAmount;\r\n                        } else if (categories.objects && categories.objects[draggedIndex]) {\r\n                            const style = categories.objects[draggedIndex][\"styleLigne\"];\r\n                            if (style) {\r\n                                Object.keys(style).forEach(key => { if (key !== \"columnIndex\" && key !== \"ordreTri\") existingProps[key] = style[key]; });\r\n                            }\r\n                        }\r\n                        existingProps.columnIndex = colIndex;\r\n                        existingProps.ordreTri = newSortIndex;\r\n                        // CLEAN undefined keys\r\n                        Object.keys(existingProps).forEach(k => { if (existingProps[k] === undefined) delete existingProps[k]; });\r\n                        // DEBUG before persist\r\n                        // eslint-disable-next-line no-console\r\n                        console.log(\"PERSIST (category) -> selector:\", selectionId.getSelector(), \"props:\", existingProps);\r\n                        // nouveau : persistance centralise\r\n                        this.persistStyle(selectionId.getSelector(), existingProps, \"styleLigne\");\r\n                        // DEBUG after persist\r\n                        // eslint-disable-next-line no-console\r\n                        console.log(\"PERSIST DONE (category) for\", draggedOriginalName);\r\n                        const draggedRowData = this.allRowsData.find(r => r.originalName === draggedOriginalName);\r\n                        if (draggedRowData) {\r\n                            draggedRowData.columnIndex = colIndex;\r\n                            draggedRowData.sortIndex = newSortIndex;\r\n                            this.pendingChanges.set(draggedOriginalName, {\r\n                                columnIndex: colIndex, sortIndex: newSortIndex,\r\n                                marginBottom: draggedRowData.marginBottom, marginTop: draggedRowData.marginTop, isHidden: draggedRowData.isHidden,\r\n                                marginColor: draggedRowData.marginColor, customLabel: draggedRowData.customLabel, customAmount: draggedRowData.customAmount,\r\n                                isHeader: draggedRowData.isHeader, fontSize: draggedRowData.fontSize, font: draggedRowData.font,\r\n                                bgLabel: draggedRowData.bgLabel, colorLabel: draggedRowData.colorLabel, italicLabel: draggedRowData.italicLabel,\r\n                                boldLabel: draggedRowData.boldLabel, bgAmount: draggedRowData.bgAmount, colorAmount: draggedRowData.colorAmount,\r\n                                boldAmount: draggedRowData.boldAmount, timestamp: Date.now()\r\n                            });\r\n                            while (this.flexContainer.firstChild) { this.flexContainer.removeChild(this.flexContainer.firstChild); }\r\n                            let maxColUsed = 1;\r\n                            this.allRowsData.forEach(r => { if (r.columnIndex > maxColUsed) maxColUsed = r.columnIndex; });\r\n                            let maxColumnsToShow = Math.max(maxColUsed, this.columnTitles.length);\r\n                            for (let i = 1; i <= maxColumnsToShow; i++) {\r\n                                const colDiv = document.createElement(\"div\");\r\n                                colDiv.className = \"dynamic-column\"; \r\n                                const table = document.createElement(\"table\");\r\n                                colDiv.appendChild(table);\r\n                                const colRows = this.allRowsData.filter(r => r.columnIndex === i);\r\n                                const colTitle = this.columnTitles[i-1] || (\"COLONNE \" + i);\r\n                                this.renderTableContent(table, colTitle, colRows, i, categories);\r\n                                this.flexContainer.appendChild(colDiv);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        tbody.appendChild(dropZoneTr);\r\n        // DEBUG: drop zone logs already handled below\r\n\r\n        targetTable.appendChild(tbody);\r\n    }\r\n\r\n    private showToolbar(row: RowData, tr: HTMLTableRowElement, x: number, y: number, categories: any) {\r\n        console.log(\" showToolbar called for:\", row.originalName);\r\n\r\n        if (!categories) {\r\n            console.error(\" Categories is null\");\r\n            return;\r\n        }\r\n\r\n        while (this.toolbar.firstChild) {\r\n            this.toolbar.removeChild(this.toolbar.firstChild);\r\n        }\r\n        this.toolbar.style.display = \"flex\";\r\n\r\n        // Stop propagation on the toolbar itself\r\n        this.toolbar.onmousedown = (e) => e.stopPropagation();\r\n        this.toolbar.onclick = (e) => e.stopPropagation();\r\n\r\n        // Positionner la toolbar\r\n        const toolbarWidth = 400; \r\n        let left = x - toolbarWidth / 2;\r\n        if (left < 10) left = 10;\r\n        if (left + toolbarWidth > window.innerWidth) left = window.innerWidth - toolbarWidth - 10;\r\n\r\n        let top = y - 50;\r\n        if (top < 10) top = y + 20;\r\n\r\n        this.toolbar.style.left = left + \"px\";\r\n        this.toolbar.style.top = top + \"px\";\r\n\r\n        const index = categories.values.findIndex(v => v.toString() === row.originalName);\r\n        console.log(\" Index found:\", index);\r\n\r\n        if (index === -1) {\r\n            console.error(\" Index not found for\", row.originalName);\r\n            return;\r\n        }\r\n\r\n        let selectionIdBuilder = this.host.createSelectionIdBuilder();\r\n        selectionIdBuilder = selectionIdBuilder.withCategory(categories, index);\r\n        const selectionId = selectionIdBuilder.createSelectionId();\r\n\r\n        // Helper pour mettre  jour pendingChanges\r\n        const updatePending = (props: any) => {\r\n            const current = this.pendingChanges.get(row.originalName) || { timestamp: Date.now() };\r\n            const updated = { ...current, ...props, timestamp: Date.now() };\r\n            this.pendingChanges.set(row.originalName, updated);\r\n        };\r\n\r\n        // Helper pour rcuprer les donnes actuelles de la ligne\r\n        const getCurrentRow = () => {\r\n            return this.allRowsData.find(r => r.originalName === row.originalName) || row;\r\n        };\r\n\r\n        // Helper pour persister TOUTES les proprits (vite les pertes)\r\n        const persistAllProps = (overrides: any) => {\r\n            const currentRow = getCurrentRow();\r\n\r\n            const fullProps: any = {\r\n                columnIndex: currentRow.columnIndex,\r\n                ordreTri: currentRow.sortIndex,\r\n                marginBottom: currentRow.marginBottom,\r\n                marginTop: currentRow.marginTop,\r\n                isHidden: currentRow.isHidden,\r\n                marginColor: { solid: { color: currentRow.marginColor } },\r\n                customLabel: currentRow.customLabel || \"\",\r\n                customAmount: currentRow.customAmount || \"\",\r\n                isHeader: currentRow.isHeader,\r\n                fontSize: currentRow.fontSize,\r\n                fontFamily: currentRow.font,\r\n                bgLabel: { solid: { color: currentRow.bgLabel } },\r\n                fillLabel: { solid: { color: currentRow.colorLabel } },\r\n                italicLabel: currentRow.italicLabel,\r\n                boldLabel: currentRow.boldLabel,\r\n                bgAmount: { solid: { color: currentRow.bgAmount } },\r\n                fillAmount: { solid: { color: currentRow.colorAmount } },\r\n                boldAmount: currentRow.boldAmount,\r\n                borderWidth: currentRow.borderWidth,\r\n                borderColor: { solid: { color: currentRow.borderColor } }\r\n            };\r\n\r\n            // Appliquer overrides fournis\r\n            Object.keys(overrides || {}).forEach(k => { fullProps[k] = overrides[k]; });\r\n\r\n            try {\r\n                this.host.persistProperties({\r\n                    merge: [{\r\n                        objectName: \"styleLigne\",\r\n                        selector: selectionId.getSelector(),\r\n                        properties: fullProps\r\n                    }]\r\n                });\r\n                updatePending(fullProps);\r\n            } catch (err) {\r\n                // eslint-disable-next-line no-console\r\n                console.error(\"Erreur persistProperties:\", err);\r\n            }\r\n        };\r\n\r\n        // --- BOUTONS ---\r\n\r\n        // GRAS (B)\r\n        const btnBold = document.createElement(\"button\");\r\n        const bElem = document.createElement(\"b\");\r\n        bElem.textContent = \"B\";\r\n        btnBold.appendChild(bElem);\r\n        \r\n        btnBold.title = \"Gras\";\r\n        if (row.boldLabel) btnBold.className = \"active\";\r\n        btnBold.onclick = (e) => {\r\n            e.stopPropagation();\r\n            const newVal = !row.boldLabel;\r\n            btnBold.className = newVal ? \"active\" : \"\";\r\n\r\n            row.boldLabel = newVal;\r\n            row.boldAmount = newVal;\r\n            const weight = newVal ? \"bold\" : \"normal\";\r\n            if (tr.cells[0]) (tr.cells[0] as HTMLElement).style.fontWeight = weight;\r\n            if (tr.cells[1]) (tr.cells[1] as HTMLElement).style.fontWeight = weight;\r\n\r\n            updatePending({ boldLabel: newVal, boldAmount: newVal });\r\n            persistAllProps({ boldLabel: newVal, boldAmount: newVal });\r\n        };\r\n        this.toolbar.appendChild(btnBold);\r\n\r\n        // ITALIQUE (I)\r\n        const btnItalic = document.createElement(\"button\");\r\n        const iElem = document.createElement(\"i\");\r\n        iElem.textContent = \"I\";\r\n        btnItalic.appendChild(iElem);\r\n\r\n        btnItalic.title = \"Italique\";\r\n        if (row.italicLabel) btnItalic.className = \"active\";\r\n        btnItalic.onclick = (e) => {\r\n            e.stopPropagation();\r\n            const newVal = !row.italicLabel;\r\n            btnItalic.className = newVal ? \"active\" : \"\";\r\n\r\n            row.italicLabel = newVal;\r\n            const style = newVal ? \"italic\" : \"normal\";\r\n            if (tr.cells[0]) (tr.cells[0] as HTMLElement).style.fontStyle = style;\r\n\r\n            updatePending({ italicLabel: newVal });\r\n            persistAllProps({ italicLabel: newVal });\r\n        };\r\n        this.toolbar.appendChild(btnItalic);\r\n\r\n        // SEPARATEUR\r\n        const sep1 = document.createElement(\"div\");\r\n        sep1.className = \"separator\";\r\n        this.toolbar.appendChild(sep1);\r\n\r\n        // TAILLE POLICE (slecteur)\r\n        const fontSizeWrapper = document.createElement(\"div\");\r\n        fontSizeWrapper.className = \"font-size-wrapper\";\r\n        const lblFontSize = document.createElement(\"label\");\r\n        lblFontSize.innerText = \"Taille\";\r\n        lblFontSize.style.marginRight = \"4px\";\r\n        fontSizeWrapper.appendChild(lblFontSize);\r\n\r\n        const selectFontSize = document.createElement(\"select\");\r\n        selectFontSize.title = \"Taille de police\";\r\n        for (let s = 8; s <= 24; s++) {\r\n            const opt = document.createElement(\"option\");\r\n            opt.value = s.toString();\r\n            opt.innerText = s.toString();\r\n            if (row.fontSize === s) opt.selected = true;\r\n            selectFontSize.appendChild(opt);\r\n        }\r\n        selectFontSize.onchange = (e) => {\r\n            e.stopPropagation();\r\n            const s = parseInt(selectFontSize.value, 10);\r\n            row.fontSize = s;\r\n            tr.style.fontSize = s + \"px\";\r\n            updatePending({ fontSize: s });\r\n            persistAllProps({ fontSize: s });\r\n        };\r\n        fontSizeWrapper.appendChild(selectFontSize);\r\n        this.toolbar.appendChild(fontSizeWrapper);\r\n\r\n        // SEPARATEUR\r\n        const sep3 = document.createElement(\"div\");\r\n        sep3.className = \"separator\";\r\n        this.toolbar.appendChild(sep3);\r\n\r\n        // POLICE (font-family)\r\n        const fontFamilyWrapper = document.createElement(\"div\");\r\n        fontFamilyWrapper.className = \"font-family-wrapper\";\r\n        const lblFontFamily = document.createElement(\"label\");\r\n        lblFontFamily.innerText = \"Police\";\r\n        lblFontFamily.style.marginRight = \"4px\";\r\n        fontFamilyWrapper.appendChild(lblFontFamily);\r\n\r\n        const selectFontFamily = document.createElement(\"select\");\r\n        selectFontFamily.title = \"Police\";\r\n        const fonts = [\r\n            { name: \"Segoe UI\", value: \"'Segoe UI', sans-serif\" },\r\n            { name: \"Arial\", value: \"Arial, sans-serif\" },\r\n            { name: \"Calibri\", value: \"Calibri, sans-serif\" },\r\n            { name: \"Times New Roman\", value: \"'Times New Roman', serif\" },\r\n            { name: \"Courier New\", value: \"'Courier New', monospace\" }\r\n        ];\r\n        fonts.forEach(f => {\r\n            const opt = document.createElement(\"option\");\r\n            opt.value = f.value;\r\n            opt.innerText = f.name;\r\n            if (row.font === f.value) opt.selected = true;\r\n            selectFontFamily.appendChild(opt);\r\n        });\r\n        selectFontFamily.onchange = (e) => {\r\n            e.stopPropagation();\r\n            const f = selectFontFamily.value;\r\n            row.font = f;\r\n            tr.style.fontFamily = f;\r\n            updatePending({ font: f });\r\n            persistAllProps({ fontFamily: f });\r\n        };\r\n        fontFamilyWrapper.appendChild(selectFontFamily);\r\n        this.toolbar.appendChild(fontFamilyWrapper);\r\n\r\n        // BOUTON FERMER\r\n        const btnClose = document.createElement(\"button\");\r\n        btnClose.className = \"close-btn\";\r\n        // CORRECTION: Utiliser textContent\r\n        btnClose.textContent = \"\";\r\n        btnClose.onclick = (e) => {\r\n            e.stopPropagation();\r\n            this.toolbar.style.display = \"none\";\r\n        };\r\n        this.toolbar.appendChild(btnClose);\r\n    }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Visual } from \"../../src/visual\";\nimport powerbiVisualsApi from \"powerbi-visuals-api\";\nimport IVisualPlugin = powerbiVisualsApi.visuals.plugins.IVisualPlugin;\nimport VisualConstructorOptions = powerbiVisualsApi.extensibility.visual.VisualConstructorOptions;\nimport DialogConstructorOptions = powerbiVisualsApi.extensibility.visual.DialogConstructorOptions;\nvar powerbiKey: any = \"powerbi\";\nvar powerbi: any = window[powerbiKey];\nvar monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG: IVisualPlugin = {\n    name: 'monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG',\n    displayName: 'monTableauPerso',\n    class: 'Visual',\n    apiVersion: '5.10.0',\n    create: (options?: VisualConstructorOptions) => {\n        if (Visual) {\n            return new Visual(options);\n        }\n        throw 'Visual instance not found';\n    },\n    createModalDialog: (dialogId: string, options: DialogConstructorOptions, initialState: object) => {\n        const dialogRegistry = (<any>globalThis).dialogRegistry;\n        if (dialogId in dialogRegistry) {\n            new dialogRegistry[dialogId](options, initialState);\n        }\n    },\n    custom: true\n};\nif (typeof powerbi !== \"undefined\") {\n    powerbi.visuals = powerbi.visuals || {};\n    powerbi.visuals.plugins = powerbi.visuals.plugins || {};\n    powerbi.visuals.plugins[\"monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG\"] = monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG;\n}\nexport default monTableauPersoCF0BED4C19044D588EBF656397EF1EB4_DEBUG;"],"names":[],"ignoreList":[],"sourceRoot":""}